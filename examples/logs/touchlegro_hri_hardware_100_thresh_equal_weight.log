Importing module 'gym_38' (/home/roboguest/Downloads/IsaacGym_Preview_4_Package/isaacgym/python/isaacgym/_bindings/linux-x86_64/gym_38.so)
Setting GYM_USD_PLUG_INFO_PATH to /home/roboguest/Downloads/IsaacGym_Preview_4_Package/isaacgym/python/isaacgym/_bindings/linux-x86_64/usd/plugInfo.json
PyTorch version 2.4.0+cu121
Device count 3
/home/roboguest/Downloads/IsaacGym_Preview_4_Package/isaacgym/python/isaacgym/_bindings/src/gymtorch
ninja: no work to do.
CCAI_PATH /home/roboguest/Documents/ccai
joint command publisher initialized.
ros listner initialized.
Root coor: [0.2981769  0.08977464 0.49515274]
Root ori: [-1.89117295 -0.36639978  0.77750963]
joint command publisher initialized.
joint state subscriber initialized.
Not connected to PVD
Physics Engine: PhysX
Physics Device: cpu
GPU Pipeline: disabled
Using VHACD cache directory '/home/roboguest/.isaacgym/vhacd'
Found existing convex decomposition for mesh '/home/roboguest/Documents/git_packages/isaacgym-arm-envs/isaac_victor_envs/assets/touchlegro/meshes/allegro_hand/base_link.STL'
Found existing convex decomposition for mesh '/home/roboguest/Documents/git_packages/isaacgym-arm-envs/isaac_victor_envs/assets/touchlegro/meshes/allegro_hand/link_1.0.STL'
Found existing convex decomposition for mesh '/home/roboguest/Documents/git_packages/isaacgym-arm-envs/isaac_victor_envs/assets/touchlegro/meshes/touchlab/visualiser4.stl'
Hardware mode
Datetime: .06.12.25:10:43:10
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'touchlegro_screwdriver_hri_hardware_low_budget_faster_computer', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': False, 'external_wrench_perturb': False, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/touchlegro_screwdriver_recovery_pi_2_100_equal_downweight_diffusion', 'model_path': 'data/training/allegro_screwdriver/touchlegro_screwdriver_recovery_pi_2_100_equal_downweight_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/touchlegro_screwdriver_pi_2_best_traj_only_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/touchlegro_screwdriver_pi_2_best_traj_only_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -100.0, 'likelihood_num_samples': 8, 'start_ind': 0, 'end_ind': 50, 'N_contact_plan': 32, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Loaded trajectory sampler
Current orientation: tensor([ 0.0094, -0.0167,  1.1265], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0075, -0.0178,  1.2371], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current orientation: tensor([ 0.0112, -0.0174,  1.2237], device='cuda:0')
1 turn
Likelihood: -50.52228546142578
Sampling time 4.899584236991359
tensor([ 0.1023,  0.3191,  0.7616,  0.7540, -0.0908,  0.8142,  0.5547,  0.8228,
         0.8145,  0.7558,  0.6980,  0.7931,  0.0127, -0.0150,  1.2204],
       device='cuda:0')
Solve time for step 1 (global step 0) 11.99483019899344
Current ori: tensor([ 0.0124, -0.0149,  1.2204], device='cuda:0')
Middle force: tensor([1.2144, 1.0378, 1.0673, 1.6267, 1.6399, 1.6299, 0.9134, 2.6102, 2.3449,
        1.0026, 1.0189, 1.2646], device='cuda:0')
Thumb force: tensor([1.0987, 3.0538, 0.9909, 1.4092, 1.3761, 1.7030, 1.0625, 1.0015, 2.2833,
        1.0331, 1.0326, 1.1693], device='cuda:0')
Index force: tensor([1.5785, 1.0431, 1.0442, 1.0265, 1.0299, 1.0277, 1.2222, 1.0043, 1.2352,
        0.9819, 0.9948, 1.0344], device='cuda:0')
tensor([ 0.0127, -0.0150,  1.2204], device='cuda:0')
tensor([ 0.1056,  0.3138,  0.7685,  0.7544, -0.0911,  0.7401,  0.6381,  0.9483,
         0.9156,  0.6836,  0.5490,  0.8522,  0.0289, -0.0219,  1.0233],
       device='cuda:0')
Likelihood: -77.35209655761719
Solve time for step 2 (global step 0) 11.200824210012797
Current ori: tensor([ 0.0284, -0.0222,  1.0232], device='cuda:0')
Middle force: tensor([1.0317, 1.0615, 1.5972, 1.6136, 1.6179, 1.0116, 2.5682, 2.3303, 1.0021,
        1.0161, 1.2613], device='cuda:0')
Thumb force: tensor([2.9623, 1.0052, 1.3778, 1.3447, 1.6464, 1.0604, 1.0009, 2.1886, 1.0273,
        1.0278, 1.1447], device='cuda:0')
Index force: tensor([1.0377, 1.0422, 1.0236, 1.0268, 1.0241, 1.2534, 1.0033, 1.2156, 1.0112,
        1.0036, 1.0312], device='cuda:0')
tensor([ 0.0289, -0.0219,  1.0233], device='cuda:0')
tensor([ 0.0708,  0.3289,  0.7460,  0.7313, -0.1003,  0.7125,  0.6428,  0.9741,
         0.9586,  0.6744,  0.6172,  0.6522,  0.0068, -0.0108,  0.8893],
       device='cuda:0')
Likelihood: -78.59706115722656
Solve time for step 3 (global step 0) 10.452243375009857
Current ori: tensor([ 0.0068, -0.0105,  0.8892], device='cuda:0')
Middle force: tensor([1.0274, 1.0319, 1.0361, 1.0353, 1.1425, 1.0110, 1.0370, 1.0001, 1.0136,
        1.0107], device='cuda:0')
Thumb force: tensor([1.0004, 1.2187, 1.3059, 1.3495, 1.1268, 1.1323, 1.9539, 1.2224, 1.3876,
        1.5155], device='cuda:0')
Index force: tensor([1.0270, 1.0364, 1.0454, 1.0434, 1.0084, 1.0272, 1.0646, 1.0331, 1.0004,
        1.0071], device='cuda:0')
tensor([ 0.0068, -0.0108,  0.8893], device='cuda:0')
tensor([ 0.0731,  0.3284,  0.7469,  0.7192, -0.1035,  0.6920,  0.6592,  0.9945,
         1.0143,  0.6329,  0.6507,  0.4995,  0.0096, -0.0058,  0.7927],
       device='cuda:0')
Likelihood: -95.4117431640625
Solve time for step 4 (global step 0) 9.838469633017667
Current ori: tensor([ 0.0110, -0.0056,  0.7925], device='cuda:0')
Middle force: tensor([1.0243, 1.0288, 1.0274, 1.1277, 1.0081, 1.0301, 1.0000, 1.0099, 1.0070],
       device='cuda:0')
Thumb force: tensor([1.1923, 1.2880, 1.3364, 1.1138, 1.1226, 1.9174, 1.2026, 1.3706, 1.5010],
       device='cuda:0')
Index force: tensor([1.0313, 1.0403, 1.0379, 1.0067, 1.0238, 1.0545, 1.0285, 1.0002, 1.0057],
       device='cuda:0')
tensor([ 0.0096, -0.0058,  0.7927], device='cuda:0')
tensor([ 0.0781,  0.3289,  0.7492,  0.7160, -0.1041,  0.6560,  0.6914,  1.0348,
         1.0415,  0.6092,  0.7032,  0.3580,  0.0062, -0.0048,  0.6686],
       device='cuda:0')
Likelihood: -105.45433044433594
State is out of distribution
Warning: Contact mode not found for: [0. 0. 1.]
Likelihoods: tensor([ -1.9289,  -1.9520,  -2.0891,  -2.0973,  -2.1736,  -2.2112,  -2.2332,
         -2.2343,  -2.2432,  -2.2684,  -2.3260,  -2.3356,  -2.3534,  -2.3593,
         -2.3898,  -2.4324,  -2.4675,  -2.4873,  -2.5057,  -2.5722,  -2.7045,
         -2.7642,  -2.8029,  -3.0461,  -3.2045,  -3.3066,  -6.6548,  -8.5706,
         -9.0447, -12.6305, -13.2509, -15.5476], device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'index' 'index' 'index' 'unknown' 'index'
 'middle']
Likelihood grouped mean: {'thumb_middle': 0.09176006205572063, 'index': 0.00039931414831736686, 'unknown': 3.2707281158818467e-06, 'middle': 1.769167699844585e-07}
Likelihood grouped sum: {'thumb_middle': 2.3857616134487363, 'index': 0.0015972565932694674, 'unknown': 3.2707281158818467e-06, 'middle': 1.769167699844585e-07}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 2.8678162379947025
Current orientation: tensor([ 0.0062, -0.0050,  0.6689], device='cuda:0')
2 thumb_middle
tensor([ 0.0778,  0.3291,  0.7496,  0.7150, -0.1044,  0.6561,  0.6913,  1.0346,
         1.0423,  0.6079,  0.7033,  0.3576,  0.0061, -0.0047,  0.6689],
       device='cuda:0')
Solve time for step 1 (global step 0) 5.500131059001433
Current ori: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
Index force: tensor([1.1485, 1.0051, 0.3874], device='cuda:0')
tensor([ 0.0061, -0.0047,  0.6689], device='cuda:0')
tensor([ 0.0065,  0.0355,  0.9063,  1.0159, -0.1653,  0.6573,  0.5932,  0.9043,
         0.9453,  0.7074,  0.6816,  0.5105,  0.0061, -0.0030,  0.6679],
       device='cuda:0')
Solve time for step 2 (global step 0) 5.247739229002036
Current ori: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
Index force: tensor([1.2587, 1.0505], device='cuda:0')
tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
tensor([-0.0324, -0.0624,  0.9055,  1.1930, -0.1964,  0.8345,  0.5935,  0.8310,
         0.9910,  0.8111,  0.6819,  0.6229,  0.0061, -0.0030,  0.6679],
       device='cuda:0')
Solve time for step 3 (global step 0) 4.923404947010567
Current ori: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
Index force: tensor([1.0704], device='cuda:0')
tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
Current orientation: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
3 turn
Likelihood: -251.62921142578125
State is out of distribution
Warning: Contact mode not found for: [0. 0. 1.]
Warning: Contact mode not found for: [ 0. -2.  3.]
Warning: Contact mode not found for: [-1. -1.  1.]
Warning: Contact mode not found for: [ 15. -14.  -8.]
Warning: Contact mode not found for: [ 2. -0.  0.]
Warning: Contact mode not found for: [ 0. -0.  1.]
Warning: Contact mode not found for: [ 1. -2. -0.]
Warning: Contact mode not found for: [-2. -1.  1.]
Warning: Contact mode not found for: [1. 5. 1.]
Warning: Contact mode not found for: [0. 0. 2.]
Warning: Contact mode not found for: [2. 0. 1.]
Warning: Contact mode not found for: [-0. -1.  0.]
Warning: Contact mode not found for: [0. 1. 2.]
Warning: Contact mode not found for: [ 1. -0.  2.]
Warning: Contact mode not found for: [ -5. -10.  -2.]
Warning: Contact mode not found for: [ 2. -1.  3.]
Warning: Contact mode not found for: [ 1. -2.  0.]
Warning: Contact mode not found for: [-1.  1.  2.]
Warning: Contact mode not found for: [4. 1. 2.]
Warning: Contact mode not found for: [ 21. -26. -17.]
Likelihoods: tensor([ -9.5768, -11.4107, -13.7445, -13.8688, -14.3301, -14.5111, -15.0601,
        -15.5184, -15.7709, -15.8155, -16.3177, -16.5972, -16.6217, -16.6495,
        -16.7414, -16.7926, -16.8488, -17.1883, -17.9884, -18.0804, -18.2120,
        -18.2965, -18.4003, -19.1507, -19.7972, -19.8108, -20.5397, -20.8723,
        -21.8167, -22.7220, -86.4960, -90.6953], device='cuda:0')
Contact modes ['thumb_middle' 'index' 'index' 'index' 'all' 'unknown' 'index' 'turn'
 'unknown' 'unknown' 'index' 'unknown' 'unknown' 'unknown' 'index' 'index'
 'middle' 'unknown' 'unknown' 'unknown' 'unknown' 'unknown' 'unknown'
 'unknown' 'unknown' 'unknown' 'unknown' 'index' 'unknown' 'unknown'
 'unknown' 'unknown']
Likelihood grouped mean: {'thumb_middle': 6.931686765476947e-05, 'index': 1.6967147496289298e-06, 'all': 5.977516186146655e-07, 'unknown': 5.329522790742287e-08, 'turn': 1.8215778719291054e-07, 'middle': 4.8156293042359835e-08}
Likelihood grouped sum: {'thumb_middle': 6.931686765476947e-05, 'index': 1.3573717997031439e-05, 'all': 5.977516186146655e-07, 'unknown': 1.0659045581484574e-06, 'turn': 1.8215778719291054e-07, 'middle': 4.8156293042359835e-08}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 2.8698378189874347
Current orientation: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
4 thumb_middle
tensor([-0.0899, -0.0842,  0.7627,  1.4655, -0.3294,  1.1708,  0.5349,  0.6651,
         1.2040,  0.9957,  0.6756,  0.6061,  0.0061, -0.0030,  0.6679],
       device='cuda:0')
Solve time for step 1 (global step 0) 5.611581542005297
Current ori: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
Index force: tensor([1.3496, 1.3656, 0.9519], device='cuda:0')
tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
tensor([-0.4068,  0.0701,  0.4984,  1.1298, -0.5405,  1.4773,  0.8519,  0.3584,
         1.3776,  0.7522,  0.4142,  0.9099,  0.0061, -0.0030,  0.6679],
       device='cuda:0')
Solve time for step 2 (global step 0) 5.246059213008266
Current ori: tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
Index force: tensor([1.2723, 0.9663], device='cuda:0')
tensor([ 0.0061, -0.0030,  0.6679], device='cuda:0')
tensor([-0.0911,  0.3962,  0.1615,  0.9712, -0.3759,  1.2129,  0.8501,  0.0609,
         1.4324,  0.6550,  0.4104,  1.1864,  0.0061, -0.0030,  0.6679],
       device='cuda:0')
