Hardware mode
Datetime: .04.27.25:09:06:17
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': False, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-0.0209,  0.0405, -0.1500], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0185,  0.0058, -0.1717], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0245,  0.0132, -0.2032], device='cuda:0')
1 turn
Likelihood: -41.2440299987793
Sampling time 3.314686579979025
tensor([ 0.1254,  0.5969,  0.5711,  0.5982, -0.1078,  0.5399,  0.9202,  0.8746,
         1.2092,  0.3229,  0.2657,  1.1283, -0.0190,  0.0091, -0.2042],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.170199121930636
Current ori: tensor([-0.0244,  0.0108, -0.2042], device='cuda:0')
Middle force: tensor([1.0470, 1.0361, 0.9795, 1.2917, 1.3893, 0.9973, 1.2303, 1.0789, 0.9590,
        1.2443, 1.0168, 0.9984], device='cuda:0')
Thumb force: tensor([1.1873, 1.0382, 1.0515, 1.9059, 1.3892, 1.0597, 1.7417, 1.0299, 1.9398,
        0.9803, 1.7152, 1.0202], device='cuda:0')
Index force: tensor([1.0209, 1.0421, 1.0472, 1.0097, 1.0332, 1.0711, 1.0056, 1.0361, 0.9804,
        1.0184, 1.0110, 1.1687], device='cuda:0')
tensor([-0.0244,  0.0108, -0.2042], device='cuda:0')
tensor([ 0.1233,  0.6203,  0.5595,  0.5502, -0.1067,  0.5384,  0.9136,  0.9480,
         1.2547,  0.3010,  0.2702,  0.9915, -0.0277,  0.0150, -0.3884],
       device='cuda:0')
Likelihood: -58.718082427978516
Solve time for step 2 (global step 1) 7.768067643046379
Current ori: tensor([-0.0278,  0.0144, -0.3890], device='cuda:0')
Middle force: tensor([1.0329, 1.4044, 1.0144, 2.3230, 1.0306, 1.3765, 1.0540, 1.0079, 1.0641,
        1.0410, 1.0342], device='cuda:0')
Thumb force: tensor([1.0065, 1.0247, 2.1959, 3.1435, 1.0151, 1.3556, 1.0250, 1.0952, 1.8548,
        1.0353, 1.0740], device='cuda:0')
Index force: tensor([1.0300, 1.0069, 1.0491, 1.0137, 1.0187, 1.0029, 1.0213, 1.0049, 1.0032,
        1.0064, 1.0415], device='cuda:0')
tensor([-0.0282,  0.0142, -0.3882], device='cuda:0')
tensor([ 0.1325,  0.6455,  0.5415,  0.5327, -0.1069,  0.5449,  0.9260,  0.9477,
         1.2864,  0.2646,  0.2755,  0.8992, -0.0308,  0.0065, -0.4460],
       device='cuda:0')
Likelihood: -94.06881713867188
Solve time for step 3 (global step 2) 7.183054369990714
Current ori: tensor([-0.0300,  0.0072, -0.4496], device='cuda:0')
Middle force: tensor([1.3856, 1.0150, 2.2868, 1.0289, 1.3605, 1.0479, 1.0061, 1.0587, 1.0367,
        1.0305], device='cuda:0')
Thumb force: tensor([1.0197, 2.1367, 3.0552, 1.0125, 1.3340, 1.0217, 1.0856, 1.8136, 1.0307,
        1.0663], device='cuda:0')
Index force: tensor([1.0057, 1.0414, 1.0118, 1.0169, 1.0025, 1.0193, 1.0043, 1.0026, 1.0054,
        1.0378], device='cuda:0')
tensor([-0.0300,  0.0072, -0.4496], device='cuda:0')
tensor([ 0.1330,  0.6382,  0.5479,  0.5437, -0.1067,  0.5277,  0.9443,  0.9767,
         1.3118,  0.2313,  0.2788,  0.8637, -0.0197,  0.0117, -0.5350],
       device='cuda:0')
Likelihood: -86.68511962890625
Solve time for step 4 (global step 3) 6.811453411006369
Current ori: tensor([-0.0201,  0.0121, -0.5342], device='cuda:0')
Middle force: tensor([1.0126, 2.2516, 1.0269, 1.3444, 1.0429, 1.0048, 1.0524, 1.0333, 1.0266],
       device='cuda:0')
Thumb force: tensor([2.1057, 2.9721, 1.0110, 1.3142, 1.0189, 1.0777, 1.7806, 1.0267, 1.0622],
       device='cuda:0')
Index force: tensor([1.0354, 1.0099, 1.0151, 1.0021, 1.0176, 1.0037, 1.0022, 1.0047, 1.0341],
       device='cuda:0')
tensor([-0.0201,  0.0121, -0.5342], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1406,  0.6654,  0.5211,  0.5378, -0.1092,  0.5409,  0.9605,  0.9847,
         1.3768,  0.1351,  0.3195,  0.7478,  0.0151, -0.0137, -0.5513],
       device='cuda:0')
Likelihood: -157.62196350097656
Solve time for step 5 (global step 4) 6.442194225965068
Current ori: tensor([ 0.0152, -0.0139, -0.5506], device='cuda:0')
Middle force: tensor([2.2167, 1.0274, 1.3292, 1.0385, 1.0039, 1.0476, 1.0299, 1.0276],
       device='cuda:0')
Thumb force: tensor([2.8800, 1.0089, 1.2933, 1.0163, 1.0675, 1.7429, 1.0219, 1.0493],
       device='cuda:0')
Index force: tensor([1.0077, 1.0126, 1.0017, 1.0157, 1.0032, 1.0017, 1.0039, 1.0303],
       device='cuda:0')
tensor([ 0.0152, -0.0139, -0.5506], device='cuda:0')
tensor([ 0.1369,  0.6455,  0.5329,  0.5585, -0.1094,  0.5054,  0.9979,  1.0602,
         1.3461,  0.3038,  0.4116,  0.5519,  0.0205, -0.0102, -0.7270],
       device='cuda:0')
Likelihood: -197.87960815429688
State is out of distribution
Likelihoods: tensor([-2.4697, -2.8416, -2.8516, -2.9482, -2.9685, -2.9724, -2.9724, -3.0067,
        -3.1021, -3.1434, -3.1504, -3.1955, -3.2831, -3.3196, -3.5326, -3.7060],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.04723022786401515}
Likelihood grouped sum: {'thumb_middle': 0.7556836458242424}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.932731296052225
Current yaw: tensor([ 0.0269, -0.0022, -0.7295], device='cuda:0')
2 thumb_middle
tensor([ 0.1370,  0.6455,  0.5330,  0.5582, -0.1098,  0.5056,  0.9979,  1.0601,
         1.3453,  0.3040,  0.4127,  0.5523,  0.0202, -0.0085, -0.7277],
       device='cuda:0')
Solve time for step 1 (global step 5) 3.841301101958379
Current ori: tensor([ 0.0252, -0.0203, -0.7200], device='cuda:0')
Index force: tensor([1.0586, 1.0603, 1.0567], device='cuda:0')
tensor([ 0.0252, -0.0203, -0.7200], device='cuda:0')
tensor([ 0.1191,  0.6520,  0.5214,  0.5333, -0.2317,  0.4667,  0.9220,  0.9637,
         1.2453,  0.3049,  0.3085,  0.7496,  0.0269, -0.0031, -0.7048],
       device='cuda:0')
Solve time for step 2 (global step 6) 3.633764634025283
Current ori: tensor([ 0.0154,  0.0077, -0.7091], device='cuda:0')
Index force: tensor([1.0526, 1.0500], device='cuda:0')
tensor([ 0.0154,  0.0077, -0.7091], device='cuda:0')
tensor([ 0.1135,  0.6727,  0.4978,  0.5060, -0.2301,  0.5023,  0.9113,  0.8710,
         1.2132,  0.2850,  0.2800,  0.9008,  0.0131,  0.0203, -0.7479],
       device='cuda:0')
Solve time for step 3 (global step 7) 3.3359403810463846
Current ori: tensor([ 0.0095,  0.0200, -0.7428], device='cuda:0')
Index force: tensor([1.0405], device='cuda:0')
tensor([ 0.0126,  0.0207, -0.7499], device='cuda:0')
Current yaw: tensor([ 0.0129, -0.0009, -0.7086], device='cuda:0')
3 turn
Likelihood: -102.53055572509766
Sampling time 3.2811118330573663
tensor([ 0.1282,  0.6924,  0.4923,  0.4754, -0.1479,  0.5793,  0.9722,  0.8549,
         1.2368,  0.2855,  0.2965,  0.9568,  0.0132, -0.0015, -0.7062],
       device='cuda:0')
Solve time for step 1 (global step 8) 8.135594050982036
Current ori: tensor([ 0.0128, -0.0010, -0.7058], device='cuda:0')
Middle force: tensor([1.4386, 0.8695, 1.2495, 1.0339, 0.8940, 1.0468, 1.0691, 1.1225, 0.9001,
        1.0222, 0.9532, 1.2064], device='cuda:0')
Thumb force: tensor([2.3866, 1.4719, 1.0010, 1.0736, 1.0201, 1.7984, 0.9341, 1.7365, 0.9093,
        1.7757, 0.9822, 1.4081], device='cuda:0')
Index force: tensor([1.0657, 1.0743, 0.9898, 0.9705, 1.0451, 1.0150, 0.9884, 0.9223, 1.1458,
        1.4057, 1.0748, 0.9771], device='cuda:0')
tensor([ 0.0128, -0.0010, -0.7058], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1306,  0.7094,  0.4602,  0.4748, -0.1694,  0.5775,  0.9719,  0.9090,
         1.3581,  0.2235,  0.2958,  0.7933,  0.0018,  0.0073, -0.9477],
       device='cuda:0')
Likelihood: -143.79965209960938
Solve time for step 2 (global step 9) 7.7503373679937795
Current ori: tensor([ 8.2279e-04,  8.0918e-03, -9.4993e-01], device='cuda:0')
Middle force: tensor([1.7592, 2.0313, 1.4485, 1.0180, 1.7096, 1.4444, 1.0181, 1.0638, 1.0239,
        1.0171, 1.0563], device='cuda:0')
Thumb force: tensor([1.0062, 1.2227, 2.6627, 1.5071, 3.7167, 1.1786, 1.0024, 1.2291, 1.0002,
        1.0449, 1.0043], device='cuda:0')
Index force: tensor([1.0427, 1.0700, 1.1796, 1.0243, 1.0054, 1.0288, 1.0217, 1.0676, 1.0335,
        1.0312, 1.0119], device='cuda:0')
tensor([ 4.9151e-04,  7.9389e-03, -9.4897e-01], device='cuda:0')
tensor([ 1.3291e-01,  7.0814e-01,  4.7110e-01,  4.6267e-01, -1.7210e-01,
         5.8050e-01,  9.7085e-01,  9.2723e-01,  1.4088e+00,  1.1637e-01,
         2.8827e-01,  7.7414e-01,  3.0927e-03,  1.1912e-03, -9.7246e-01],
       device='cuda:0')
Likelihood: -153.72889709472656
Solve time for step 3 (global step 10) 7.315571446088143
Current ori: tensor([-0.0015,  0.0083, -0.9761], device='cuda:0')
Middle force: tensor([2.0001, 1.4221, 1.0151, 1.6870, 1.4242, 1.0171, 1.0573, 1.0214, 1.0156,
        1.0514], device='cuda:0')
Thumb force: tensor([1.2010, 2.6031, 1.4854, 3.6078, 1.1657, 1.0016, 1.2089, 1.0001, 1.0401,
        1.0033], device='cuda:0')
Index force: tensor([1.0614, 1.1637, 1.0210, 1.0043, 1.0258, 1.0194, 1.0619, 1.0299, 1.0280,
        1.0106], device='cuda:0')
tensor([-0.0015,  0.0083, -0.9761], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.1434,  0.6924,  0.4991,  0.4765, -0.1721,  0.6289,  1.0083,  0.9707,
         1.3851,  0.1713,  0.3034,  0.6725,  0.0279, -0.0432, -1.3135],
       device='cuda:0')
Likelihood: -205.7415771484375
State is out of distribution
Likelihoods: tensor([-3.9457, -3.9563, -4.0855, -4.1121, -4.4978, -4.5843, -4.7012, -4.7984,
        -4.8120, -4.8198, -4.9265, -4.9438, -4.9997, -5.3717, -5.6235, -5.6256],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.009969543951146163}
Likelihood grouped sum: {'thumb_middle': 0.1595127032183386}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 2.0181526340311393
Current yaw: tensor([ 0.0234, -0.0429, -1.3071], device='cuda:0')
4 thumb_middle
tensor([ 0.1406,  0.6924,  0.4989,  0.4768, -0.1722,  0.6287,  1.0082,  0.9712,
         1.3854,  0.1714,  0.3049,  0.6723,  0.0227, -0.0418, -1.3071],
       device='cuda:0')
Solve time for step 1 (global step 11) 3.948692915029824
Current ori: tensor([ 0.0241, -0.0414, -1.3076], device='cuda:0')
Index force: tensor([1.0739, 1.0609, 1.0598], device='cuda:0')
tensor([ 0.0241, -0.0414, -1.3076], device='cuda:0')
tensor([ 0.0684,  0.6746,  0.4586,  0.4744, -0.2383,  0.5209,  0.9189,  0.8955,
         1.3102,  0.2071,  0.2353,  0.8291,  0.0255, -0.0090, -1.3397],
       device='cuda:0')
Solve time for step 2 (global step 12) 3.690437256009318
Current ori: tensor([ 0.0265, -0.0098, -1.3406], device='cuda:0')
Index force: tensor([1.0558, 1.0549], device='cuda:0')
tensor([ 0.0265, -0.0098, -1.3406], device='cuda:0')
tensor([ 0.0522,  0.6824,  0.4401,  0.4501, -0.2380,  0.5211,  0.8974,  0.8634,
         1.2266,  0.2337,  0.2356,  0.9463,  0.0219, -0.0065, -1.3726],
       device='cuda:0')
Solve time for step 3 (global step 13) 3.4986397189786658
Current ori: tensor([ 0.0211, -0.0062, -1.3788], device='cuda:0')
Index force: tensor([1.0462], device='cuda:0')
tensor([ 0.0176, -0.0052, -1.3839], device='cuda:0')
Current yaw: tensor([-0.0033,  0.0068, -1.4709], device='cuda:0')
5 turn
Likelihood: -161.5460205078125
Sampling time 3.4537496539996937
tensor([ 0.0452,  0.7395,  0.3556,  0.3844, -0.1346,  0.5970,  0.9168,  0.8380,
         1.2689,  0.2701,  0.2845,  0.9765, -0.0040,  0.0050, -1.4706],
       device='cuda:0')
Solve time for step 1 (global step 14) 8.300223622005433
Current ori: tensor([-0.0037,  0.0049, -1.4704], device='cuda:0')
Middle force: tensor([1.0664, 1.3472, 2.8833, 1.0180, 1.1953, 1.0278, 1.2300, 1.0094, 1.2396,
        1.0514, 1.0688, 1.0431], device='cuda:0')
Thumb force: tensor([0.9728, 1.6461, 1.2196, 1.5738, 1.0030, 1.1134, 1.2739, 1.0138, 1.0051,
        1.0260, 1.0009, 1.1152], device='cuda:0')
Index force: tensor([1.2650, 1.0620, 1.0073, 1.0473, 1.1682, 1.0874, 1.4203, 1.1642, 1.2615,
        0.9754, 1.0616, 1.0311], device='cuda:0')
tensor([-0.0037,  0.0049, -1.4704], device='cuda:0')
tensor([ 0.0689,  0.7180,  0.4047,  0.4149, -0.1342,  0.5807,  0.9127,  0.9504,
         1.3558,  0.1452,  0.2854,  0.8318, -0.0031, -0.0050, -1.7223],
       device='cuda:0')
Likelihood: -169.5760955810547
Solve time for step 2 (global step 15) 7.748789323028177
Current ori: tensor([-0.0020, -0.0033, -1.7223], device='cuda:0')
Middle force: tensor([1.0217, 1.5437, 2.0849, 1.0234, 1.0013, 1.0429, 1.0281, 1.1645, 1.0354,
        1.0224, 1.1970], device='cuda:0')
Thumb force: tensor([2.1689, 1.6504, 1.0408, 1.5600, 1.0173, 1.0027, 1.0337, 1.2912, 1.0359,
        1.0069, 1.0125], device='cuda:0')
Index force: tensor([1.0595, 1.0101, 1.0006, 1.0103, 1.0073, 1.0328, 1.0203, 1.0199, 1.0067,
        1.0400, 1.0052], device='cuda:0')
tensor([-0.0021, -0.0032, -1.7234], device='cuda:0')
tensor([ 0.0840,  0.7172,  0.4172,  0.4326, -0.1346,  0.5809,  0.9046,  0.9827,
         1.2756,  0.3620,  0.3374,  0.7481,  0.0022, -0.0084, -1.8206],
       device='cuda:0')
Likelihood: -160.91064453125
Solve time for step 3 (global step 16) 7.226468736073002
Current ori: tensor([-0.0092, -0.0058, -1.8198], device='cuda:0')
Middle force: tensor([1.4581, 2.0068, 1.0323, 1.0613, 1.1080, 1.7004, 1.0351, 1.0224, 1.0239,
        1.0189], device='cuda:0')
Thumb force: tensor([1.6075, 1.0107, 1.4855, 1.0138, 1.2871, 1.6519, 1.1342, 1.0320, 1.3212,
        1.0022], device='cuda:0')
Index force: tensor([1.0003, 1.0077, 1.0173, 1.0238, 1.0004, 1.5208, 1.1565, 1.0093, 1.0000,
        1.0754], device='cuda:0')
tensor([ 1.4602e-03, -1.0263e-02, -1.8206e+00], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.0673,  0.7070,  0.4152,  0.4491, -0.1370,  0.6111,  0.9125,  1.0162,
         1.3209,  0.3433,  0.3405,  0.6951,  0.0391, -0.0448, -2.1579],
       device='cuda:0')
Likelihood: -197.39349365234375
State is out of distribution
Likelihoods: tensor([-3.5591, -3.8360, -3.9766, -3.9781, -4.0655, -4.0918, -4.1152, -4.2423,
        -4.3268, -4.3945, -4.6173, -4.7023, -4.7161, -4.9176, -5.0451, -5.3208],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'index' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.013697340520693204, 'index': 0.01872198255819556}
Likelihood grouped sum: {'thumb_middle': 0.20546010781039806, 'index': 0.01872198255819556}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.825652344035916
Current yaw: tensor([ 0.0379, -0.0457, -2.1582], device='cuda:0')
6 thumb_middle
tensor([ 0.0673,  0.7070,  0.4150,  0.4490, -0.1368,  0.6114,  0.9122,  1.0161,
         1.3210,  0.3429,  0.3405,  0.6951,  0.0389, -0.0451, -2.1576],
       device='cuda:0')
Solve time for step 1 (global step 17) 3.7779724820284173
Current ori: tensor([ 0.0391, -0.0451, -2.1574], device='cuda:0')
Index force: tensor([1.1716, 1.0560, 1.0567], device='cuda:0')
tensor([ 0.0391, -0.0451, -2.1574], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([-0.0087,  0.6871,  0.3907,  0.3936, -0.2570,  0.5291,  0.8810,  0.9728,
         1.2296,  0.3367,  0.2778,  0.8534,  0.0110, -0.0125, -2.3481],
       device='cuda:0')
Solve time for step 2 (global step 18) 3.7393865500343964
Current ori: tensor([ 0.0100, -0.0122, -2.3504], device='cuda:0')
Index force: tensor([1.0428, 1.0425], device='cuda:0')
tensor([ 0.0100, -0.0122, -2.3504], device='cuda:0')
tensor([-0.0321,  0.7555,  0.2977,  0.2966, -0.2568,  0.5292,  0.8811,  0.9662,
         1.2042,  0.3367,  0.2600,  0.9305, -0.0030,  0.0084, -2.5689],
       device='cuda:0')
Solve time for step 3 (global step 19) 3.5697191120125353
Current ori: tensor([-0.0038,  0.0073, -2.5710], device='cuda:0')
Index force: tensor([1.0362], device='cuda:0')
tensor([-0.0038,  0.0073, -2.5710], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continueCurrent yaw: tensor([-0.0186,  0.0051, -2.8092], device='cuda:0')
7 turn
Likelihood: -225.3438262939453
State is out of distribution
Likelihoods: tensor([-3.4926, -3.7830, -4.1961, -4.4215, -4.4388, -4.4699, -4.4846, -4.5321,
        -4.6402, -4.7617, -4.9066, -5.3490, -5.5355, -5.7970, -6.2296, -8.4314],
       device='cuda:0')
Contact modes ['thumb_middle' 'index' 'index' 'index' 'index' 'index' 'index' 'index'
 'index' 'thumb_middle' 'index' 'index' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.008023773296105523, 'index': 0.011692696219532683}
Likelihood grouped sum: {'thumb_middle': 0.04814263977663314, 'index': 0.11692696219532683}
Contact mode with highest likelihood sum: index
Plan time: 1.9092648869846016
Current yaw: tensor([-1.9607e-02,  2.3038e-03, -2.8082e+00], device='cuda:0')
8 index
tensor([-0.0294,  0.8339,  0.1937,  0.2239, -0.1669,  0.5297,  0.9535,  0.9907,
         1.1937,  0.3531,  0.2968,  1.0929, -0.0193,  0.0053, -2.8092],
       device='cuda:0')
Solve time for step 1 (global step 20) 4.540322388056666
Current ori: tensor([-0.0186,  0.0066, -2.8109], device='cuda:0')
Middle force: tensor([1.0594, 1.0650, 1.0622], device='cuda:0')
Thumb force: tensor([1.0606, 1.0552, 1.0558], device='cuda:0')
tensor([-0.0186,  0.0066, -2.8109], device='cuda:0')
tensor([ 0.0868,  0.6813,  0.2565,  0.3433, -0.1705,  0.5763,  0.9406,  0.9303,
         1.2185,  0.3164,  0.2918,  1.0596, -0.0276,  0.0039, -2.7823],
       device='cuda:0')
Solve time for step 2 (global step 21) 4.283661887049675
Current ori: tensor([-0.0269,  0.0059, -2.7834], device='cuda:0')
Middle force: tensor([1.0525, 1.0460], device='cuda:0')
Thumb force: tensor([1.0412, 1.0451], device='cuda:0')
tensor([-0.0269,  0.0059, -2.7834], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1193,  0.6500,  0.3306,  0.4307, -0.1469,  0.6072,  0.9600,  0.9228,
         1.2372,  0.2792,  0.2585,  1.0538,  0.0198, -0.0374, -3.1283],
       device='cuda:0')
Solve time for step 3 (global step 22) 4.170328535954468
Current ori: tensor([ 0.0211, -0.0351, -3.1311], device='cuda:0')
Middle force: tensor([1.0266], device='cuda:0')
Thumb force: tensor([1.0472], device='cuda:0')
tensor([ 0.0211, -0.0351, -3.1311], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continueCurrent yaw: tensor([ 0.0891, -0.0437,  3.0492], device='cuda:0')
9 turn
Likelihood: -143.7978515625
Sampling time 3.3531902510439977
tensor([ 0.1444,  0.5530,  0.5890,  0.7285, -0.1072,  0.6813,  0.9316,  0.8332,
         1.2237,  0.3594,  0.2455,  1.1762,  0.0912, -0.0447,  3.0493],
       device='cuda:0')
Solve time for step 1 (global step 23) 8.309818928013556
Current ori: tensor([ 0.0932, -0.0437,  3.0458], device='cuda:0')
Middle force: tensor([2.2883, 1.1902, 1.0131, 2.6930, 1.6751, 1.5912, 1.0494, 1.0240, 2.5825,
        0.9148, 2.4645, 1.0048], device='cuda:0')
Thumb force: tensor([2.4706, 2.2424, 1.5014, 1.5516, 1.6418, 1.0145, 2.2717, 3.0481, 1.5936,
        0.9285, 1.6633, 1.0014], device='cuda:0')
Index force: tensor([0.9776, 0.9850, 0.9966, 1.0086, 1.0050, 0.9452, 0.9889, 1.0296, 0.9463,
        1.1639, 1.0826, 0.9093], device='cuda:0')
tensor([ 0.0895, -0.0446,  3.0482], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1017,  0.5131,  0.6150,  0.7325, -0.1547,  0.6572,  0.9831,  0.9513,
         1.3399,  0.3061,  0.2749,  1.0315,  0.1313, -0.0329,  2.7123],
       device='cuda:0')
Likelihood: -141.4906768798828
Solve time for step 2 (global step 24) 7.88694212900009
Current ori: tensor([ 0.1262, -0.0302,  2.7105], device='cuda:0')
Middle force: tensor([1.1842, 1.3319, 1.0023, 1.0360, 1.0389, 1.0415, 1.0180, 1.0203, 1.0178,
        1.3684, 1.2235], device='cuda:0')
Thumb force: tensor([2.2207, 1.0251, 2.2954, 2.0115, 1.0124, 1.0127, 1.3972, 1.0028, 1.0278,
        1.0304, 1.0232], device='cuda:0')
Index force: tensor([1.0357, 1.0026, 1.0056, 1.0003, 1.0087, 1.0960, 1.0416, 1.0346, 1.0373,
        1.0374, 1.0298], device='cuda:0')
tensor([ 0.1262, -0.0302,  2.7105], device='cuda:0')
tensor([ 0.1211,  0.5204,  0.6447,  0.6966, -0.1533,  0.6573,  0.9806,  1.0074,
         1.4206,  0.1742,  0.2616,  0.9623,  0.1255, -0.0440,  2.5944],
       device='cuda:0')
Likelihood: -159.10565185546875
Solve time for step 3 (global step 25) 7.284971415065229
Current ori: tensor([ 0.1230, -0.0442,  2.5943], device='cuda:0')
Middle force: tensor([1.0588, 1.0010, 1.0475, 1.0218, 1.2148, 1.1678, 1.0147, 1.7479, 1.0239,
        1.0079], device='cuda:0')
Thumb force: tensor([1.0078, 1.0202, 1.0022, 1.0141, 1.0808, 1.0880, 1.0110, 1.2821, 1.0174,
        1.0985], device='cuda:0')
Index force: tensor([1.0149, 1.1840, 1.0226, 1.0179, 1.0274, 1.0447, 0.9993, 1.0634, 1.0524,
        1.0321], device='cuda:0')
tensor([ 0.1247, -0.0439,  2.5951], device='cuda:0')
tensor([ 0.0786,  0.5053,  0.6441,  0.6286, -0.1487,  0.6720,  0.9949,  0.9748,
         1.3503,  0.4169,  0.3490,  0.8648,  0.1420, -0.0351,  2.6627],
       device='cuda:0')
Likelihood: -161.07254028320312
Solve time for step 4 (global step 26) 6.953130712965503
Current ori: tensor([ 0.1386, -0.0363,  2.6579], device='cuda:0')
Middle force: tensor([1.0009, 1.0418, 1.0141, 1.1955, 1.1531, 1.0140, 1.7160, 1.0203, 1.0055],
       device='cuda:0')
Thumb force: tensor([1.0179, 1.0012, 1.0123, 1.0832, 1.0855, 1.0080, 1.2725, 1.0150, 1.0952],
       device='cuda:0')
Index force: tensor([1.1929, 1.0239, 1.0221, 1.0258, 1.0421, 1.0007, 1.0594, 1.0481, 1.0295],
       device='cuda:0')
tensor([ 0.1392, -0.0342,  2.6600], device='cuda:0')
tensor([ 0.0835,  0.5137,  0.6353,  0.6285, -0.1491,  0.7047,  0.9889,  0.9748,
         1.3465,  0.4143,  0.3143,  0.9350,  0.1564, -0.0579,  2.6798],
       device='cuda:0')
Likelihood: -193.2725830078125
State is out of distribution
Likelihoods: tensor([-4.6158, -5.5477, -5.6421, -5.9876, -6.0463, -6.0590, -6.1777, -6.4211,
        -6.8933, -7.4121, -7.4177, -7.4886, -7.7573, -8.0722, -8.5794, -8.7236],
       device='cuda:0')
Contact modes ['index' 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'index': 0.009894473371370172, 'thumb_middle': 0.0014816877761599644}
Likelihood grouped sum: {'index': 0.009894473371370172, 'thumb_middle': 0.022225316642399465}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.8638767669908702
Current yaw: tensor([ 0.3264, -0.2448, -2.7766], device='cuda:0')
10 thumb_middle
tensor([ 0.0835,  0.5508,  0.6357,  0.6286, -0.1477,  0.7047,  0.9889,  0.9749,
         1.3472,  0.4137,  0.3102,  0.9443,  0.3265, -0.2430, -2.7774],
       device='cuda:0')
Solve time for step 1 (global step 27) 3.9542833770392463
Current ori: tensor([ 1.7429, -1.0965, -2.1062], device='cuda:0')
Index force: tensor([0.8574, 0.7255, 0.8008], device='cuda:0')
tensor([ 1.7429, -1.0965, -2.1062], device='cuda:0')
tensor([ 0.0799,  0.5693,  0.5001,  0.6004, -0.2663,  0.5203,  0.9133,  0.9132,
         1.3156,  0.3697,  0.2978,  1.0516,  1.7328, -1.1017, -2.1140],
       device='cuda:0')
Solve time for step 2 (global step 28) 3.5927072759950534
Current ori: tensor([ 1.7399, -1.0967, -2.1093], device='cuda:0')
Index force: tensor([0.7925, 0.8705], device='cuda:0')
tensor([ 1.7399, -1.0967, -2.1093], device='cuda:0')
tensor([-0.1157,  0.7198,  0.5001,  0.6223, -0.1536,  0.5631,  0.9659,  0.8865,
         1.2522,  0.3456,  0.2177,  1.0515,  1.7443, -1.0972, -2.1051],
       device='cuda:0')
Solve time for step 3 (global step 29) 3.456139779998921
Current ori: tensor([ 1.7433, -1.0965, -2.1064], device='cuda:0')
Index force: tensor([0.8869], device='cuda:0')
tensor([ 1.7433, -1.0965, -2.1064], device='cuda:0')
Probably dropped the object
tensor([ 1.7404, -1.0974, -2.1091], device='cuda:0')
Likelihood: -831.3226928710938
State is out of distribution
{}

Trial 2
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([ 1.7458, -1.0937, -2.0997], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.