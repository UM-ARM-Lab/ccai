Hardware mode
Datetime: .04.26.25:11:10:08
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': False, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Loaded trajectory sampler
Current yaw: tensor([-0.0272, -0.0130,  2.6033], device='cuda:0')
tensor([-0.0506, -0.0281,  2.6069], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0364, -0.0214,  2.3361], device='cuda:0')
1 turn
Likelihood: -130.23292541503906
Sampling time 3.3191098000388592
tensor([ 0.1093,  0.6117,  0.5459,  0.6125, -0.0461,  0.5335,  0.8106,  0.9508,
         1.1619,  0.3365,  0.2916,  1.2147, -0.0365, -0.0211,  2.3362],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.327681745984592
Current ori: tensor([-0.0412, -0.0174,  2.3355], device='cuda:0')
Middle force: tensor([0.9056, 1.1313, 0.5109, 0.5434, 0.8037, 0.6964, 0.8988, 1.7060, 1.6483,
        0.5003, 0.6392, 0.7055], device='cuda:0')
Thumb force: tensor([1.7778, 1.3863, 0.7023, 0.8161, 0.5625, 0.7951, 1.0808, 0.5659, 2.1067,
        0.6963, 0.5952, 0.8812], device='cuda:0')
Index force: tensor([0.5961, 0.7994, 0.7472, 0.8339, 0.6438, 0.7414, 0.5721, 1.0880, 1.0747,
        0.5943, 0.5129, 0.5346], device='cuda:0')
tensor([-0.0412, -0.0174,  2.3355], device='cuda:0')
tensor([ 0.1001,  0.6122,  0.5461,  0.5878, -0.0511,  0.5145,  0.8220,  0.9760,
         1.1676,  0.3350,  0.3398,  1.0771, -0.0461, -0.0122,  2.2431],
       device='cuda:0')
Likelihood: -136.7599639892578
Solve time for step 2 (global step 1) 7.75172082404606
Current ori: tensor([-0.0473, -0.0128,  2.2414], device='cuda:0')
Middle force: tensor([3.0554, 0.8537, 1.8220, 1.9251, 2.3836, 0.8365, 1.1340, 0.7468, 0.8949,
        0.5359, 0.7477], device='cuda:0')
Thumb force: tensor([3.2265, 0.8568, 1.4345, 1.8765, 2.2604, 1.1486, 1.4330, 0.9384, 0.5211,
        0.7676, 1.0885], device='cuda:0')
Index force: tensor([0.6143, 1.2003, 0.7377, 0.7369, 0.7044, 0.5398, 0.5229, 0.6443, 0.6975,
        0.5473, 0.5738], device='cuda:0')
tensor([-0.0459, -0.0117,  2.2412], device='cuda:0')
tensor([ 0.0905,  0.6255,  0.5267,  0.5622, -0.0564,  0.4858,  0.8643,  0.9905,
         1.2646,  0.2548,  0.3332,  0.9336, -0.0598, -0.0083,  2.0296],
       device='cuda:0')
Likelihood: -154.4590606689453
Solve time for step 3 (global step 2) 7.532637506024912
Current ori: tensor([-0.0534, -0.0072,  2.0287], device='cuda:0')
Middle force: tensor([0.8195, 1.7575, 1.8542, 2.2820, 0.8108, 0.9113, 1.1244, 0.9914, 0.5241,
        0.6734], device='cuda:0')
Thumb force: tensor([0.8352, 1.4210, 1.7740, 2.1917, 1.1278, 1.1414, 1.4829, 0.6657, 1.1498,
        1.0517], device='cuda:0')
Index force: tensor([1.1832, 0.7076, 0.7222, 0.7055, 0.5308, 0.6562, 0.7592, 0.5323, 0.6481,
        0.5395], device='cuda:0')
tensor([-0.0534, -0.0072,  2.0287], device='cuda:0')
tensor([ 0.0862,  0.6261,  0.5266,  0.5601, -0.0520,  0.4597,  0.8900,  0.9958,
         1.3005,  0.2097,  0.3246,  0.8640, -0.0487, -0.0112,  1.9894],
       device='cuda:0')
Likelihood: -150.4107666015625
Solve time for step 4 (global step 3) 6.79413554596249
Current ori: tensor([-0.0484, -0.0113,  1.9903], device='cuda:0')
Middle force: tensor([0.5474, 0.7762, 0.7012, 0.8165, 1.5191, 1.5504, 0.5001, 0.6163, 0.6658],
       device='cuda:0')
Thumb force: tensor([0.7296, 0.5282, 0.6782, 0.9853, 0.5483, 1.8782, 0.6510, 0.5600, 0.8103],
       device='cuda:0')
Index force: tensor([0.7523, 0.6209, 0.6935, 0.5471, 1.0103, 1.0203, 0.5777, 0.5058, 0.5248],
       device='cuda:0')
tensor([-0.0484, -0.0113,  1.9903], device='cuda:0')
tensor([ 0.0891,  0.6086,  0.5516,  0.5606, -0.0513,  0.4483,  0.8898,  1.0304,
         1.2977,  0.2489,  0.3495,  0.8011, -0.0572, -0.0117,  1.9391],
       device='cuda:0')
Likelihood: -169.61691284179688
Solve time for step 5 (global step 4) 6.35079507692717
Current ori: tensor([-0.0579, -0.0120,  1.9384], device='cuda:0')
Middle force: tensor([0.6267, 0.6574, 0.7985, 0.6367, 1.6712, 0.8097, 0.5201, 0.5287],
       device='cuda:0')
Thumb force: tensor([0.7489, 0.9238, 1.1238, 0.5078, 2.1780, 1.7187, 0.5028, 0.5392],
       device='cuda:0')
Index force: tensor([0.8293, 0.7480, 0.7570, 0.8338, 0.7785, 0.6699, 0.5995, 0.7337],
       device='cuda:0')
tensor([-0.0579, -0.0120,  1.9384], device='cuda:0')
tensor([ 0.0889,  0.5961,  0.5599,  0.5809, -0.0509,  0.4466,  0.8800,  1.0711,
         1.3170,  0.2279,  0.3496,  0.7677, -0.0536, -0.0079,  1.9293],
       device='cuda:0')
Likelihood: -195.65687561035156
State is out of distribution
Likelihoods: tensor([-3.4222, -3.4277, -3.7450, -3.8161, -3.8651, -3.8703, -3.8764, -3.8995,
        -3.9785, -4.0076, -4.0279, -4.0654, -4.1382, -4.3583, -4.5564, -5.4922],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.01929790302854076}
Likelihood grouped sum: {'thumb_middle': 0.3087664484566522}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.9276791780721396
Current yaw: tensor([-0.0545, -0.0082,  1.9293], device='cuda:0')
2 thumb_middle
tensor([ 0.0888,  0.5960,  0.5601,  0.5807, -0.0511,  0.4468,  0.8797,  1.0712,
         1.3177,  0.2279,  0.3494,  0.7676, -0.0495, -0.0106,  1.9326],
       device='cuda:0')
Solve time for step 1 (global step 5) 3.9826968900160864
Current ori: tensor([-0.0503, -0.0114,  1.9325], device='cuda:0')
Index force: tensor([0.5052, 0.5440, 0.5551], device='cuda:0')
tensor([-0.0503, -0.0114,  1.9325], device='cuda:0')
tensor([ 0.0722,  0.6258,  0.5169,  0.5483, -0.1803,  0.4460,  0.8594,  1.0005,
         1.2448,  0.2280,  0.2446,  0.8742, -0.0497,  0.0025,  1.9654],
       device='cuda:0')
Solve time for step 2 (global step 6) 3.664627632009797
Current ori: tensor([-0.0481, -0.0065,  1.9674], device='cuda:0')
Index force: tensor([0.5447, 0.5550], device='cuda:0')
tensor([-0.0481, -0.0065,  1.9674], device='cuda:0')
tensor([ 7.2137e-02,  6.5489e-01,  4.9682e-01,  4.9373e-01, -1.8048e-01,
         4.4648e-01,  8.7612e-01,  9.4072e-01,  1.2436e+00,  2.2804e-01,
         2.2572e-01,  9.3449e-01, -7.4199e-02,  1.3696e-03,  1.9386e+00],
       device='cuda:0')
Solve time for step 3 (global step 7) 3.5161687679355964
Current ori: tensor([-0.0751,  0.0041,  1.9361], device='cuda:0')
Index force: tensor([0.5521], device='cuda:0')
tensor([-0.0751,  0.0041,  1.9361], device='cuda:0')
Current yaw: tensor([-0.0673, -0.0208,  2.0773], device='cuda:0')
3 turn
Likelihood: -151.23374938964844
Sampling time 3.254138225922361
tensor([ 0.0731,  0.6771,  0.4957,  0.4270, -0.1120,  0.6393,  0.8490,  0.8211,
         1.2966,  0.2419,  0.2312,  0.9761, -0.0665, -0.0202,  2.0781],
       device='cuda:0')
Solve time for step 1 (global step 8) 8.339885515975766
Current ori: tensor([-0.0667, -0.0203,  2.0771], device='cuda:0')
Middle force: tensor([1.4751, 2.2112, 1.1058, 0.5426, 0.9664, 0.7011, 1.2226, 0.5301, 0.7862,
        0.6881, 0.7039, 0.7593], device='cuda:0')
Thumb force: tensor([1.0195, 0.9655, 1.0500, 0.5922, 1.5039, 0.5722, 0.9050, 0.6269, 0.7535,
        0.5235, 1.0550, 1.6192], device='cuda:0')
Index force: tensor([0.9568, 1.0124, 0.9139, 0.6647, 0.5849, 0.5356, 0.6286, 0.5769, 0.7606,
        0.7065, 0.6894, 1.0306], device='cuda:0')
tensor([-0.0667, -0.0203,  2.0771], device='cuda:0')
tensor([ 0.0846,  0.6641,  0.4945,  0.5055, -0.1011,  0.6088,  0.8776,  0.8876,
         1.3178,  0.2548,  0.2438,  0.8786, -0.0503, -0.0320,  1.9802],
       device='cuda:0')
Likelihood: -155.49911499023438
Solve time for step 2 (global step 9) 8.09787611104548
Current ori: tensor([-0.0493, -0.0321,  1.9803], device='cuda:0')
Middle force: tensor([0.7684, 1.5264, 1.5622, 0.5146, 1.0821, 0.9542, 1.4421, 0.9596, 0.7636,
        0.5410, 1.1063], device='cuda:0')
Thumb force: tensor([1.7941, 1.1632, 1.3331, 1.0106, 0.6304, 1.1022, 1.6970, 1.2602, 0.6042,
        2.0710, 0.5829], device='cuda:0')
Index force: tensor([0.6531, 0.8357, 0.8341, 0.5224, 0.6904, 1.0679, 0.9598, 0.5141, 0.7178,
        0.7989, 0.6902], device='cuda:0')
tensor([-0.0493, -0.0321,  1.9803], device='cuda:0')
tensor([ 0.0835,  0.6364,  0.5205,  0.5281, -0.1029,  0.6086,  0.8742,  0.8929,
         1.2921,  0.3001,  0.2739,  0.8787, -0.0528, -0.0242,  2.0063],
       device='cuda:0')
Likelihood: -137.849853515625
Solve time for step 3 (global step 10) 7.806728117051534
Current ori: tensor([-0.0522, -0.0234,  2.0087], device='cuda:0')
Middle force: tensor([1.1068, 0.5145, 0.9554, 1.0444, 0.7810, 0.5451, 1.0678, 1.1992, 0.5699,
        1.6035], device='cuda:0')
Thumb force: tensor([1.0248, 0.5582, 1.4414, 1.4860, 1.3389, 0.5424, 1.6078, 1.7472, 0.8689,
        0.5548], device='cuda:0')
Index force: tensor([0.8617, 0.6101, 0.5541, 0.5109, 0.5941, 0.5844, 0.6395, 0.5717, 0.8800,
        0.8591], device='cuda:0')
tensor([-0.0522, -0.0234,  2.0087], device='cuda:0')
tensor([ 0.0927,  0.6348,  0.5222,  0.5387, -0.1009,  0.5981,  0.8766,  0.9345,
         1.3508,  0.1990,  0.2735,  0.7757, -0.0439, -0.0231,  1.9360],
       device='cuda:0')
