Hardware mode
Datetime: .04.26.25:10:09:05
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-4.7536e-02, -1.6291e-04,  1.2117e+00], device='cuda:0')
tensor([-0.0498, -0.0200,  1.1931], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0368, -0.0183,  1.1661], device='cuda:0')
1 turn
Likelihood: -83.94644927978516
Sampling time 3.489805851946585
tensor([ 0.1330,  0.6323,  0.5574,  0.5356, -0.1134,  0.5058,  1.0000,  0.8458,
         1.1965,  0.2870,  0.2599,  1.1836, -0.0365, -0.0187,  1.1661],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.506968681933358
Current ori: tensor([-0.0366, -0.0190,  1.1663], device='cuda:0')
Middle force: tensor([2.4556, 1.0365, 2.8408, 1.1300, 0.5557, 1.5484, 2.1521, 1.9470, 0.8354,
        2.0640, 1.6427, 1.9296], device='cuda:0')
Thumb force: tensor([1.9547, 1.2658, 2.2733, 1.1249, 0.8497, 0.5469, 1.3781, 1.4873, 0.9055,
        1.0742, 0.9499, 1.4645], device='cuda:0')
Index force: tensor([0.8678, 1.5699, 0.8727, 0.5755, 0.5053, 0.9012, 0.8561, 0.6560, 0.8435,
        0.5913, 0.6848, 0.5408], device='cuda:0')
tensor([-0.0377, -0.0192,  1.1656], device='cuda:0')
tensor([ 0.1326,  0.6310,  0.5534,  0.5538, -0.1203,  0.5038,  1.0012,  0.9139,
         1.2211,  0.2831,  0.2675,  1.0908, -0.0406, -0.0183,  0.9959],
       device='cuda:0')
Likelihood: -92.15291595458984
Solve time for step 2 (global step 1) 8.106171921011992
Current ori: tensor([-0.0407, -0.0189,  0.9949], device='cuda:0')
Middle force: tensor([1.0475, 2.7912, 1.1250, 0.5544, 1.5162, 2.0984, 1.9102, 0.8308, 2.0210,
        1.6123, 1.8974], device='cuda:0')
Thumb force: tensor([1.2110, 2.1849, 1.0834, 0.8289, 0.5409, 1.3362, 1.4386, 0.8820, 1.0423,
        0.9206, 1.4097], device='cuda:0')
Index force: tensor([1.5399, 0.8477, 0.5692, 0.5046, 0.8799, 0.8376, 0.6471, 0.8264, 0.5849,
        0.6700, 0.5360], device='cuda:0')
tensor([-0.0407, -0.0189,  0.9949], device='cuda:0')
tensor([ 0.1304,  0.6138,  0.5660,  0.5820, -0.1185,  0.4936,  0.9725,  0.9654,
         1.3281,  0.0965,  0.2366,  1.0590, -0.0308, -0.0176,  0.9559],
       device='cuda:0')
Likelihood: -119.90647888183594
Solve time for step 3 (global step 2) 7.250885873916559
Current ori: tensor([-0.0303, -0.0166,  0.9544], device='cuda:0')
Middle force: tensor([2.7128, 1.1057, 0.5522, 1.4756, 2.0291, 1.8660, 0.8106, 1.9715, 1.5742,
        1.8603], device='cuda:0')
Thumb force: tensor([2.1108, 1.0564, 0.8107, 0.5355, 1.3059, 1.3987, 0.8658, 1.0149, 0.8959,
        1.3600], device='cuda:0')
Index force: tensor([0.8318, 0.5634, 0.5038, 0.8659, 0.8254, 0.6403, 0.8166, 0.5801, 0.6580,
        0.5326], device='cuda:0')
tensor([-0.0303, -0.0166,  0.9544], device='cuda:0')
tensor([ 0.1304,  0.6077,  0.5674,  0.5935, -0.1201,  0.4876,  0.9749,  1.0136,
         1.3752,  0.0482,  0.2438,  0.9793, -0.0286, -0.0127,  0.8433],
       device='cuda:0')
Likelihood: -138.71011352539062
Solve time for step 4 (global step 3) 7.206478959997185
Current ori: tensor([-0.0283, -0.0120,  0.8423], device='cuda:0')
Middle force: tensor([1.0808, 0.5505, 1.4356, 1.9595, 1.8231, 0.7845, 1.9276, 1.5309, 1.8196],
       device='cuda:0')
Thumb force: tensor([1.0262, 0.7931, 0.5303, 1.2805, 1.3549, 0.8562, 0.9829, 0.8711, 1.3129],
       device='cuda:0')
Index force: tensor([0.5557, 0.5028, 0.8514, 0.8120, 0.6319, 0.8046, 0.5749, 0.6465, 0.5301],
       device='cuda:0')
tensor([-0.0283, -0.0120,  0.8423], device='cuda:0')
tensor([ 0.1359,  0.5999,  0.5671,  0.6296, -0.1182,  0.4684,  0.9803,  1.0547,
         1.3654,  0.0832,  0.2654,  0.9148, -0.0355, -0.0019,  0.7556],
       device='cuda:0')
Likelihood: -143.48561096191406
Solve time for step 5 (global step 4) 6.505140895023942
Current ori: tensor([-0.0356, -0.0023,  0.7558], device='cuda:0')
Middle force: tensor([0.5457, 1.4025, 1.8952, 1.7766, 0.7598, 1.8812, 1.4898, 1.7740],
       device='cuda:0')
Thumb force: tensor([0.7729, 0.5261, 1.2573, 1.3199, 0.8502, 0.9581, 0.8522, 1.2779],
       device='cuda:0')
Index force: tensor([0.5022, 0.8347, 0.7993, 0.6262, 0.7927, 0.5712, 0.6383, 0.5289],
       device='cuda:0')
tensor([-0.0356, -0.0023,  0.7558], device='cuda:0')
tensor([ 0.1284,  0.5892,  0.5665,  0.6458, -0.1209,  0.4547,  0.9799,  1.0682,
         1.3484,  0.1310,  0.3041,  0.8521, -0.0441,  0.0032,  0.7181],
       device='cuda:0')
Likelihood: -154.04244995117188
Solve time for step 6 (global step 5) 5.939486347022466
Current ori: tensor([-0.0440,  0.0031,  0.7178], device='cuda:0')
Middle force: tensor([1.4239, 1.2009, 0.5896, 0.7648, 0.6291, 0.5928, 0.5139],
       device='cuda:0')
Thumb force: tensor([3.0165, 0.9634, 0.6568, 0.7789, 0.6197, 0.5949, 0.6204],
       device='cuda:0')
Index force: tensor([0.8353, 0.5575, 0.7192, 0.5247, 0.5204, 0.6472, 0.8673],
       device='cuda:0')
tensor([-0.0440,  0.0031,  0.7178], device='cuda:0')
tensor([ 0.1319,  0.5579,  0.6095,  0.6453, -0.1186,  0.4343,  1.0017,  1.0902,
         1.3796,  0.1384,  0.3074,  0.7728, -0.0470,  0.0017,  0.6328],
       device='cuda:0')
Likelihood: -185.39022827148438
State is out of distribution
