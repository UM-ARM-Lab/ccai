Hardware mode
Datetime: .04.26.25:10:32:41
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-0.0147, -0.0191,  2.6378], device='cuda:0')
tensor([-0.0071, -0.0245,  2.6251], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0056, -0.0441,  2.5956], device='cuda:0')
1 turn
Likelihood: -64.8169174194336
Sampling time 3.372333502047695
tensor([ 0.1533,  0.6233,  0.5597,  0.5981, -0.0989,  0.5377,  0.9373,  0.8811,
         1.2068,  0.2694,  0.2355,  1.2347, -0.0048, -0.0448,  2.5950],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.870587548939511
Current ori: tensor([-0.0046, -0.0454,  2.5952], device='cuda:0')
Middle force: tensor([1.0415, 1.4907, 0.7179, 1.3155, 0.5008, 1.1391, 1.0454, 0.8601, 0.5794,
        1.0760, 0.6093, 0.5852], device='cuda:0')
Thumb force: tensor([1.4490, 1.2801, 1.3566, 1.2197, 0.8648, 1.0461, 1.3087, 0.5002, 1.7437,
        0.8746, 0.5643, 0.6290], device='cuda:0')
Index force: tensor([0.7653, 0.7185, 1.1676, 1.1284, 0.5453, 0.8619, 1.0444, 0.5491, 0.5208,
        0.7484, 0.6538, 0.8897], device='cuda:0')
tensor([-0.0046, -0.0454,  2.5952], device='cuda:0')
tensor([ 0.1277,  0.6277,  0.5447,  0.5414, -0.1036,  0.6020,  0.8716,  0.8213,
         1.2106,  0.2691,  0.2492,  1.2346, -0.0139, -0.0386,  2.7222],
       device='cuda:0')
Likelihood: -79.02214050292969
Solve time for step 2 (global step 1) 8.146565656992607
Current ori: tensor([-0.0203, -0.0406,  2.7233], device='cuda:0')
Middle force: tensor([2.6920, 0.6163, 1.1140, 1.5886, 2.1885, 0.5599, 0.8361, 2.0853, 1.5093,
        0.5524, 0.6140], device='cuda:0')
Thumb force: tensor([1.5194, 1.0047, 1.9993, 3.2977, 1.0164, 1.0171, 1.0868, 1.4922, 1.1762,
        1.3647, 0.7182], device='cuda:0')
Index force: tensor([0.7170, 0.8671, 0.7098, 1.2349, 0.6689, 0.5308, 1.1216, 0.8164, 0.9750,
        0.6703, 0.5583], device='cuda:0')
tensor([-0.0203, -0.0400,  2.7215], device='cuda:0')
tensor([ 0.1196,  0.6284,  0.5349,  0.5402, -0.1037,  0.6180,  0.8703,  0.8194,
         1.1656,  0.3316,  0.2755,  1.2076, -0.0200, -0.0424,  2.7058],
       device='cuda:0')
Likelihood: -96.73455810546875
Solve time for step 3 (global step 2) 7.518793737050146
Current ori: tensor([-0.0148, -0.0450,  2.7082], device='cuda:0')
Middle force: tensor([0.6262, 1.0982, 1.6187, 2.1305, 0.5615, 0.8376, 2.0503, 1.4892, 0.5502,
        0.6159], device='cuda:0')
Thumb force: tensor([0.9741, 1.9538, 3.1893, 1.0012, 0.9974, 1.0596, 1.4478, 1.1460, 1.3399,
        0.7066], device='cuda:0')
Index force: tensor([0.8540, 0.7028, 1.2045, 0.6698, 0.5303, 1.1004, 0.8052, 0.9555, 0.6643,
        0.5554], device='cuda:0')
tensor([-0.0148, -0.0450,  2.7082], device='cuda:0')
tensor([ 0.1099,  0.6299,  0.5255,  0.5342, -0.1026,  0.6010,  0.8722,  0.8252,
         1.2342,  0.2351,  0.2296,  1.2078, -0.0184, -0.0386,  2.6733],
       device='cuda:0')
Likelihood: -71.83895874023438
Solve time for step 4 (global step 3) 7.1295822790125385
Current ori: tensor([-0.0193, -0.0386,  2.6734], device='cuda:0')
Middle force: tensor([1.0642, 1.6108, 2.0710, 0.5610, 0.8316, 2.0148, 1.4582, 0.5480, 0.6159],
       device='cuda:0')
Thumb force: tensor([1.9097, 3.1016, 0.9886, 0.9835, 1.0383, 1.4083, 1.1249, 1.3168, 0.6966],
       device='cuda:0')
Index force: tensor([0.7018, 1.1804, 0.6690, 0.5290, 1.0818, 0.7970, 0.9414, 0.6581, 0.5532],
       device='cuda:0')
tensor([-0.0193, -0.0386,  2.6734], device='cuda:0')
tensor([ 0.1104,  0.6307,  0.5243,  0.5333, -0.1042,  0.5777,  0.8949,  0.8615,
         1.2583,  0.2247,  0.2293,  1.1430, -0.0180, -0.0376,  2.5457],
       device='cuda:0')
Likelihood: -64.17427062988281
Solve time for step 5 (global step 4) 6.607033194974065
Current ori: tensor([-0.0170, -0.0376,  2.5456], device='cuda:0')
Middle force: tensor([1.5727, 2.0158, 0.5601, 0.8249, 1.9878, 1.4238, 0.5461, 0.6177],
       device='cuda:0')
Thumb force: tensor([3.0177, 0.9746, 0.9705, 1.0211, 1.3642, 1.1073, 1.2948, 0.6860],
       device='cuda:0')
Index force: tensor([1.1613, 0.6672, 0.5276, 1.0605, 0.7861, 0.9297, 0.6520, 0.5504],
       device='cuda:0')
tensor([-0.0170, -0.0376,  2.5456], device='cuda:0')
tensor([ 0.0984,  0.6369,  0.5042,  0.5150, -0.1047,  0.5323,  0.9289,  0.9090,
         1.3104,  0.2237,  0.2638,  0.9314, -0.0450, -0.0252,  2.2567],
       device='cuda:0')
Likelihood: -143.91705322265625
Solve time for step 6 (global step 5) 6.294355520047247
Current ori: tensor([-0.0451, -0.0260,  2.2561], device='cuda:0')
Middle force: tensor([1.9606, 0.5581, 0.8012, 1.9413, 1.3853, 0.5422, 0.6156],
       device='cuda:0')
Thumb force: tensor([0.9543, 0.9557, 1.0121, 1.3294, 1.0902, 1.2755, 0.6759],
       device='cuda:0')
Index force: tensor([0.6554, 0.5252, 1.0448, 0.7786, 0.9171, 0.6446, 0.5470],
       device='cuda:0')
tensor([-0.0451, -0.0260,  2.2561], device='cuda:0')
tensor([ 0.1099,  0.6217,  0.5287,  0.5524, -0.1035,  0.5164,  0.9504,  0.9451,
         1.3152,  0.1988,  0.2622,  0.8999, -0.0389, -0.0344,  2.1839],
       device='cuda:0')
Likelihood: -145.48202514648438
Solve time for step 7 (global step 6) 5.760550581966527
Current ori: tensor([-0.0397, -0.0345,  2.1835], device='cuda:0')
Middle force: tensor([0.5519, 0.7951, 1.9136, 1.3553, 0.5394, 0.6141], device='cuda:0')
Thumb force: tensor([0.9362, 0.9867, 1.2809, 1.0655, 1.2490, 0.6634], device='cuda:0')
Index force: tensor([0.5230, 1.0246, 0.7636, 0.9029, 0.6392, 0.5432], device='cuda:0')
tensor([-0.0397, -0.0345,  2.1835], device='cuda:0')
tensor([ 0.1059,  0.5923,  0.5498,  0.5868, -0.1013,  0.4868,  0.9740,  0.9696,
         1.3286,  0.1809,  0.2982,  0.8170, -0.0288, -0.0359,  2.1691],
       device='cuda:0')
Likelihood: -170.92913818359375
State is out of distribution
Likelihoods: tensor([-4.5777, -4.6269, -4.8325, -4.8650, -4.9081, -4.9752, -5.0283, -5.0957,
        -5.1189, -5.1980, -5.2436, -5.2735, -5.5549, -5.6206, -5.6335, -5.6387],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.00620302811435844}
Likelihood grouped sum: {'thumb_middle': 0.09924844982973503}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.9508689269423485
Current yaw: tensor([-0.0291, -0.0348,  2.1711], device='cuda:0')
2 thumb_middle
tensor([ 0.1059,  0.5924,  0.5498,  0.5863, -0.1014,  0.4865,  0.9737,  0.9697,
         1.3288,  0.1808,  0.2985,  0.8170, -0.0299, -0.0351,  2.1697],
       device='cuda:0')
Solve time for step 1 (global step 7) 3.9343566210009158
Current ori: tensor([-0.0291, -0.0350,  2.1711], device='cuda:0')
Index force: tensor([0.5267, 0.5261, 0.5293], device='cuda:0')
tensor([-0.0299, -0.0352,  2.1715], device='cuda:0')
tensor([ 0.0447,  0.5775,  0.5228,  0.5673, -0.1577,  0.4833,  0.9244,  0.8979,
         1.2737,  0.1922,  0.2371,  0.8849, -0.0232, -0.0035,  2.2461],
       device='cuda:0')
Solve time for step 2 (global step 8) 3.758298582979478
Current ori: tensor([-0.0231, -0.0026,  2.2467], device='cuda:0')
Index force: tensor([0.5241, 0.5283], device='cuda:0')
tensor([-0.0231, -0.0026,  2.2467], device='cuda:0')
tensor([ 0.0457,  0.6239,  0.4729,  0.5270, -0.1578,  0.4833,  0.8919,  0.8305,
         1.2607,  0.2431,  0.2229,  0.8876, -0.0420, -0.0040,  2.2237],
       device='cuda:0')
Solve time for step 3 (global step 9) 3.3714736140100285
Current ori: tensor([-0.0358, -0.0036,  2.2261], device='cuda:0')
Index force: tensor([0.5244], device='cuda:0')
tensor([-0.0358, -0.0036,  2.2261], device='cuda:0')
