Hardware mode
Datetime: .04.26.25:10:28:14
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([ 0.0252, -0.0373,  2.9593], device='cuda:0')
tensor([-2.7824e-03, -4.1889e-02,  2.9477e+00], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([ 0.0035, -0.0420,  2.9455], device='cuda:0')
1 turn
Likelihood: -91.15641784667969
Sampling time 3.393746383022517
tensor([ 0.1385,  0.5959,  0.5474,  0.6592, -0.1044,  0.5310,  0.9536,  0.8973,
         1.1821,  0.3582,  0.2856,  1.0929,  0.0041, -0.0381,  2.9428],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.134238151018508
Current ori: tensor([-1.0536e-03, -4.0534e-02,  2.9401e+00], device='cuda:0')
Middle force: tensor([1.0025, 1.2770, 0.6306, 1.3161, 0.5196, 1.0581, 0.5578, 1.4326, 1.1805,
        1.3463, 1.1886, 0.7405], device='cuda:0')
Thumb force: tensor([1.4296, 1.2184, 1.4052, 1.2069, 0.8684, 0.9804, 0.8365, 0.9999, 0.7134,
        1.1930, 0.9465, 0.5114], device='cuda:0')
Index force: tensor([0.6911, 0.7020, 1.1894, 1.1088, 0.5577, 0.8546, 0.5544, 0.5339, 0.7941,
        0.6477, 0.5906, 0.5372], device='cuda:0')
tensor([-1.0536e-03, -4.0534e-02,  2.9401e+00], device='cuda:0')
tensor([ 0.1419,  0.6105,  0.5494,  0.6266, -0.1058,  0.4992,  0.9817,  0.9992,
         1.2475,  0.3042,  0.2910,  0.9305, -0.0075, -0.0494,  2.6630],
       device='cuda:0')
Likelihood: -117.13678741455078
Solve time for step 2 (global step 1) 7.989182694931515
Current ori: tensor([-0.0079, -0.0514,  2.6578], device='cuda:0')
Middle force: tensor([1.2285, 0.7587, 1.3046, 0.5213, 1.0539, 0.5529, 1.4066, 1.1730, 1.3277,
        1.1749, 0.7373], device='cuda:0')
Thumb force: tensor([1.1536, 1.2480, 1.1189, 0.8363, 0.9224, 0.8162, 0.9490, 0.6741, 1.1410,
        0.9017, 0.5061], device='cuda:0')
Index force: tensor([0.6832, 1.0850, 1.0627, 0.5548, 0.8175, 0.5458, 0.5297, 0.7649, 0.6316,
        0.5829, 0.5296], device='cuda:0')
tensor([-0.0079, -0.0514,  2.6578], device='cuda:0')
tensor([ 1.3621e-01,  6.0335e-01,  5.5446e-01,  6.2686e-01, -1.0877e-01,
         5.2495e-01,  9.5894e-01,  9.7105e-01,  1.2465e+00,  2.8463e-01,
         2.8568e-01,  9.5177e-01, -2.0251e-04, -5.2753e-02,  2.7722e+00],
       device='cuda:0')
Likelihood: -102.83802795410156
Solve time for step 3 (global step 2) 7.368815160007216
Current ori: tensor([-1.4159e-03, -5.2210e-02,  2.7728e+00], device='cuda:0')
Middle force: tensor([0.7439, 1.2997, 0.5182, 1.0471, 1.0389, 1.5268, 0.6895, 0.8259, 1.3616,
        1.0783], device='cuda:0')
Thumb force: tensor([1.2104, 1.0756, 0.8161, 0.8928, 1.1314, 0.9588, 1.6438, 1.5987, 1.0975,
        0.9543], device='cuda:0')
Index force: tensor([1.0352, 0.9801, 0.5447, 0.7703, 0.9241, 0.5013, 0.9380, 0.9318, 0.6393,
        1.0757], device='cuda:0')
tensor([-1.4159e-03, -5.2210e-02,  2.7728e+00], device='cuda:0')
tensor([ 1.1862e-01,  6.0462e-01,  5.4858e-01,  5.9360e-01, -1.0955e-01,
         5.6359e-01,  9.1154e-01,  9.3001e-01,  1.2512e+00,  2.5463e-01,
         2.9716e-01,  9.5205e-01, -6.3761e-04, -4.2464e-02,  2.9165e+00],
       device='cuda:0')
Likelihood: -81.50703430175781
Solve time for step 4 (global step 3) 7.740831270930357
Current ori: tensor([ 0.0034, -0.0356,  2.9154], device='cuda:0')
Middle force: tensor([1.2399, 0.5185, 0.9865, 0.9932, 1.4293, 0.6578, 0.7877, 1.2912, 1.0205],
       device='cuda:0')
Thumb force: tensor([1.0540, 0.8074, 0.8537, 1.0631, 0.9003, 1.5553, 1.5214, 1.0544, 0.9073],
       device='cuda:0')
Index force: tensor([0.9092, 0.5397, 0.7433, 0.8724, 0.5005, 0.8961, 0.9086, 0.6264, 1.0341],
       device='cuda:0')
tensor([ 0.0034, -0.0356,  2.9154], device='cuda:0')
tensor([ 0.1236,  0.5880,  0.5690,  0.6076, -0.1092,  0.5228,  0.9465,  0.9823,
         1.2925,  0.2369,  0.3471,  0.7779,  0.0035, -0.0466,  2.8019],
       device='cuda:0')
Likelihood: -149.5594940185547
Solve time for step 5 (global step 4) 6.55205677007325
Current ori: tensor([ 1.5714e-03, -4.5413e-02,  2.8021e+00], device='cuda:0')
Middle force: tensor([0.5172, 0.9640, 0.9659, 1.3471, 0.6328, 0.7561, 1.2273, 0.9801],
       device='cuda:0')
Thumb force: tensor([0.8189, 0.8169, 1.0117, 0.8577, 1.4793, 1.4516, 1.0177, 0.8587],
       device='cuda:0')
Index force: tensor([0.5376, 0.7131, 0.8212, 0.5000, 0.8585, 0.8870, 0.6154, 0.9903],
       device='cuda:0')
tensor([ 1.5714e-03, -4.5413e-02,  2.8021e+00], device='cuda:0')
tensor([ 1.1833e-01,  5.8805e-01,  5.6872e-01,  6.0434e-01, -1.0923e-01,
         4.9865e-01,  9.6729e-01,  1.0215e+00,  1.3572e+00,  1.6300e-01,
         3.9875e-01,  5.7681e-01, -6.2182e-04, -4.4011e-02,  2.6898e+00],
       device='cuda:0')
Likelihood: -198.8162384033203
State is out of distribution
