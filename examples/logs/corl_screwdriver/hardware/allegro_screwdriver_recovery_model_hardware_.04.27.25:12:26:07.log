Hardware mode
Datetime: .04.27.25:12:26:07
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': False, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([ 1.1794e-03,  8.3515e-03, -1.7085e+00], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0033, -0.0050, -1.6675], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([ 0.0143, -0.0023, -1.6627], device='cuda:0')
1 turn
Likelihood: -71.63290405273438
Sampling time 3.3829732389422134
tensor([ 0.1239,  0.6019,  0.5893,  0.5342, -0.0633,  0.5370,  0.8698,  0.9192,
         1.1784,  0.2992,  0.2825,  1.2243,  0.0145, -0.0057, -1.6601],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.44184161699377
Current ori: tensor([ 0.0147, -0.0030, -1.6633], device='cuda:0')
Middle force: tensor([1.1592, 1.8339, 2.1097, 1.0141, 1.7435, 1.0231, 1.0580, 1.0297, 1.4284,
        0.9304, 1.0485, 1.0368], device='cuda:0')
Thumb force: tensor([1.2725, 1.0219, 1.5407, 1.0978, 1.8543, 0.9944, 0.9419, 0.9940, 1.3264,
        1.1483, 1.0063, 1.0244], device='cuda:0')
Index force: tensor([1.1466, 0.9910, 0.9723, 1.0490, 1.0117, 1.3829, 0.9760, 1.1822, 1.0144,
        1.0559, 1.0464, 1.0431], device='cuda:0')
tensor([ 0.0147, -0.0030, -1.6633], device='cuda:0')
tensor([ 1.1637e-01,  6.0723e-01,  5.7103e-01,  5.3591e-01, -6.3278e-02,
         5.3037e-01,  8.6932e-01,  9.5019e-01,  1.1722e+00,  3.5245e-01,
         3.2032e-01,  1.1016e+00,  2.6424e-03,  8.0427e-04, -1.7917e+00],
       device='cuda:0')
Likelihood: -61.79533386230469
Solve time for step 2 (global step 1) 7.807626027031802
Current ori: tensor([ 2.6927e-03,  1.1021e-03, -1.7935e+00], device='cuda:0')
Middle force: tensor([1.7814, 2.0731, 1.0119, 1.7216, 1.0199, 1.0525, 1.0214, 1.4025, 1.0290,
        1.0382, 1.0280], device='cuda:0')
Thumb force: tensor([1.0184, 1.4856, 1.0884, 1.7687, 1.0023, 1.0331, 1.0042, 1.3006, 1.1398,
        1.0052, 1.0172], device='cuda:0')
Index force: tensor([1.0056, 1.0155, 1.0430, 1.0094, 1.3678, 1.0145, 1.1709, 1.0127, 1.0548,
        1.0414, 1.0383], device='cuda:0')
tensor([ 2.6927e-03,  1.1021e-03, -1.7935e+00], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.0983,  0.6018,  0.5480,  0.5577, -0.0577,  0.5087,  0.8906,  0.9693,
         1.2257,  0.2966,  0.3095,  1.0403,  0.0450, -0.0115, -2.1127],
       device='cuda:0')
Likelihood: -100.32760620117188
Solve time for step 3 (global step 2) 7.307614748948254
Current ori: tensor([ 0.0453, -0.0119, -2.1127], device='cuda:0')
Middle force: tensor([2.0376, 1.0135, 1.6919, 1.0215, 1.0462, 1.0373, 1.3787, 1.0301, 1.0570,
        1.0225], device='cuda:0')
Thumb force: tensor([1.4257, 1.0661, 1.6979, 1.0012, 1.0294, 1.0016, 1.2774, 1.1112, 1.0023,
        1.0117], device='cuda:0')
Index force: tensor([1.0123, 1.0357, 1.0076, 1.3373, 1.0120, 1.1510, 1.0112, 1.0466, 1.0359,
        1.0335], device='cuda:0')
tensor([ 0.0453, -0.0119, -2.1127], device='cuda:0')
tensor([ 0.0848,  0.6119,  0.5255,  0.5558, -0.0658,  0.5037,  0.9003,  0.9689,
         1.2775,  0.2470,  0.3080,  0.9606,  0.0344, -0.0204, -2.2080],
       device='cuda:0')
Likelihood: -98.6461410522461
Solve time for step 4 (global step 3) 6.749791380017996
Current ori: tensor([ 0.0337, -0.0206, -2.2078], device='cuda:0')
Middle force: tensor([1.0142, 1.6791, 1.0235, 1.0416, 1.0472, 1.3565, 1.0293, 1.0642, 1.0178],
       device='cuda:0')
Thumb force: tensor([1.0548, 1.6563, 1.0006, 1.0262, 1.0007, 1.2564, 1.0920, 1.0013, 1.0076],
       device='cuda:0')
Index force: tensor([1.0282, 1.0058, 1.3020, 1.0099, 1.1240, 1.0099, 1.0397, 1.0292, 1.0298],
       device='cuda:0')
tensor([ 0.0337, -0.0206, -2.2078], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.0782,  0.6118,  0.5134,  0.5492, -0.0400,  0.5166,  0.9043,  0.9697,
         1.3105,  0.2058,  0.3113,  0.9009,  0.0447, -0.0234, -2.4278],
       device='cuda:0')
Likelihood: -164.67767333984375
Solve time for step 5 (global step 4) 6.426392987952568
Current ori: tensor([ 0.0453, -0.0249, -2.4269], device='cuda:0')
Middle force: tensor([1.6376, 1.0221, 1.0371, 1.0541, 1.3302, 1.0257, 1.0700, 1.0145],
       device='cuda:0')
Thumb force: tensor([1.6193, 1.0004, 1.0235, 1.0004, 1.2406, 1.0811, 1.0009, 1.0050],
       device='cuda:0')
Index force: tensor([1.0047, 1.2820, 1.0084, 1.1035, 1.0090, 1.0362, 1.0238, 1.0270],
       device='cuda:0')
tensor([ 0.0453, -0.0249, -2.4269], device='cuda:0')
tensor([ 0.0638,  0.6349,  0.4808,  0.5130, -0.0471,  0.5231,  0.9022,  0.9630,
         1.3822,  0.1387,  0.3478,  0.7278,  0.0376, -0.0211, -2.5038],
       device='cuda:0')
Likelihood: -175.457275390625
State is out of distribution
Likelihoods: tensor([-4.1368, -4.1741, -4.2029, -4.3105, -4.3262, -4.4288, -4.4688, -4.4724,
        -4.5275, -4.6008, -4.7011, -4.7846, -4.7914, -4.8513, -4.8786, -5.1715],
       device='cuda:0')
Contact modes ['thumb_middle' 'index' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.010671775658893984, 'index': 0.015389022077782057}
Likelihood grouped sum: {'thumb_middle': 0.16007663488340976, 'index': 0.015389022077782057}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.806693288963288
Current yaw: tensor([ 0.0371, -0.0197, -2.5033], device='cuda:0')
2 thumb_middle
tensor([ 0.0631,  0.6349,  0.4809,  0.5121, -0.0469,  0.5232,  0.9020,  0.9626,
         1.3821,  0.1380,  0.3479,  0.7277,  0.0351, -0.0154, -2.5040],
       device='cuda:0')
Solve time for step 1 (global step 5) 3.951120381942019
Current ori: tensor([ 0.0378, -0.0227, -2.5019], device='cuda:0')
Index force: tensor([1.0573, 1.0524, 1.0559], device='cuda:0')
tensor([ 0.0319, -0.0132, -2.5068], device='cuda:0')
tensor([ 0.0421,  0.5532,  0.5402,  0.6059, -0.1683,  0.4591,  0.8606,  0.8963,
         1.2970,  0.1505,  0.2753,  0.8518,  0.0643,  0.0091, -2.4417],
       device='cuda:0')
Solve time for step 2 (global step 6) 3.7290186310419813
Current ori: tensor([ 0.0595,  0.0146, -2.4441], device='cuda:0')
Index force: tensor([1.0413, 1.0448], device='cuda:0')
tensor([ 0.0595,  0.0146, -2.4441], device='cuda:0')
tensor([ 0.0522,  0.5577,  0.5427,  0.6057, -0.1685,  0.4591,  0.8396,  0.8902,
         1.2943,  0.1549,  0.2610,  0.9292,  0.0580,  0.0122, -2.4314],
       device='cuda:0')
Solve time for step 3 (global step 7) 3.3905363180674613
Current ori: tensor([ 0.0565,  0.0150, -2.4336], device='cuda:0')
Index force: tensor([1.0366], device='cuda:0')
tensor([ 0.0565,  0.0150, -2.4336], device='cuda:0')
Current yaw: tensor([ 5.5685e-02, -6.5297e-04, -2.4127e+00], device='cuda:0')
3 turn
Likelihood: -130.00042724609375
Sampling time 3.2248571149539202
tensor([ 6.5365e-02,  5.8403e-01,  5.1791e-01,  6.1687e-01, -7.3707e-02,
         5.0015e-01,  8.9598e-01,  9.4737e-01,  1.3036e+00,  1.8445e-01,
         2.9209e-01,  9.9118e-01,  5.2895e-02,  4.1702e-04, -2.4150e+00],
       device='cuda:0')
Solve time for step 1 (global step 8) 8.261306961998343
Current ori: tensor([ 5.4236e-02, -2.3475e-03, -2.4125e+00], device='cuda:0')
Middle force: tensor([1.2693, 0.9976, 1.0166, 2.2139, 0.9197, 1.0763, 1.1755, 1.1246, 1.0122,
        1.1380, 0.8991, 1.3835], device='cuda:0')
Thumb force: tensor([1.0380, 1.2614, 0.9501, 1.1928, 1.0802, 1.7480, 1.0011, 1.5367, 0.9750,
        0.9575, 1.1367, 1.2426], device='cuda:0')
Index force: tensor([1.0094, 0.9369, 0.9284, 0.9469, 1.0204, 0.8881, 0.8918, 0.8915, 0.9635,
        0.9481, 1.2998, 1.0862], device='cuda:0')
tensor([ 5.4236e-02, -2.3475e-03, -2.4125e+00], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.0605,  0.5632,  0.5349,  0.6108, -0.0619,  0.5341,  0.8511,  0.9820,
         1.3038,  0.2678,  0.3433,  0.9434,  0.0915, -0.0171, -2.9323],
       device='cuda:0')
Likelihood: -145.44100952148438
Solve time for step 2 (global step 9) 7.765877995989285
Current ori: tensor([ 0.0832, -0.0163, -2.9280], device='cuda:0')
Middle force: tensor([0.9998, 1.0118, 2.2196, 1.0448, 1.0678, 1.1790, 1.1423, 1.0084, 1.1256,
        1.0516, 1.4407], device='cuda:0')
Thumb force: tensor([1.2242, 1.0148, 1.1604, 1.0519, 1.6898, 1.0002, 1.4660, 1.0070, 1.0175,
        1.0851, 1.1809], device='cuda:0')
Index force: tensor([1.0244, 1.0306, 1.0162, 1.0157, 1.0391, 1.0329, 1.0215, 1.0139, 1.0209,
        1.2833, 1.0597], device='cuda:0')
tensor([ 0.0832, -0.0163, -2.9280], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.0158,  0.5584,  0.5188,  0.6010, -0.0474,  0.5799,  0.8324,  1.0253,
         1.2942,  0.3449,  0.3835,  0.8519,  0.1041, -0.0297,  3.0686],
       device='cuda:0')
Likelihood: -160.18798828125
Solve time for step 3 (global step 10) 7.337921195081435
Current ori: tensor([ 0.1089, -0.0290,  3.0708], device='cuda:0')
Middle force: tensor([1.0009, 1.0985, 1.0631, 1.0141, 1.0190, 1.2340, 1.0479, 1.0003, 1.0089,
        1.0000], device='cuda:0')
Thumb force: tensor([1.0139, 1.0247, 1.5590, 1.2767, 1.0019, 1.3431, 1.0116, 1.0030, 1.0597,
        1.0119], device='cuda:0')
Index force: tensor([1.0008, 1.0156, 1.7411, 1.0001, 1.0088, 1.0212, 1.0292, 1.0246, 1.0121,
        1.0279], device='cuda:0')
tensor([ 0.1094, -0.0228,  3.0675], device='cuda:0')
tensor([ 0.0230,  0.5248,  0.5520,  0.6719, -0.0471,  0.5771,  0.8938,  1.0101,
         1.3536,  0.2681,  0.3019,  0.9417,  0.1196, -0.0397,  3.0846],
       device='cuda:0')
Likelihood: -160.96530151367188
Solve time for step 4 (global step 11) 6.779134516022168
Current ori: tensor([ 0.1180, -0.0400,  3.0852], device='cuda:0')
Middle force: tensor([1.0596, 1.5032, 1.7451, 1.5691, 1.3941, 1.4542, 1.8083, 0.9996, 1.2272],
       device='cuda:0')
Thumb force: tensor([0.9992, 2.1214, 1.2675, 1.2974, 1.6329, 1.0487, 1.0028, 0.9992, 1.0120],
       device='cuda:0')
Index force: tensor([1.0572, 1.0012, 1.0098, 1.0038, 1.0127, 1.2998, 1.1286, 1.0057, 1.0194],
       device='cuda:0')
tensor([ 0.1180, -0.0400,  3.0852], device='cuda:0')
tensor([ 0.0243,  0.5364,  0.5484,  0.6527, -0.0471,  0.5770,  0.9282,  0.9850,
         1.3037,  0.4037,  0.3421,  0.9172,  0.1204, -0.0445,  3.0978],
       device='cuda:0')
Likelihood: -155.72021484375
Solve time for step 5 (global step 12) 6.339861564920284
Current ori: tensor([ 0.1208, -0.0447,  3.0974], device='cuda:0')
Middle force: tensor([1.0425, 1.0262, 1.0020, 0.9989, 1.1701, 1.0051, 0.9995, 1.0099],
       device='cuda:0')
Thumb force: tensor([1.0418, 1.0002, 1.0802, 1.3523, 2.4798, 1.0350, 1.0002, 1.1457],
       device='cuda:0')
Index force: tensor([1.0016, 1.0003, 1.0009, 1.0017, 1.0094, 1.2554, 1.0045, 1.0227],
       device='cuda:0')
tensor([ 0.1208, -0.0447,  3.0974], device='cuda:0')
tensor([ 0.0063,  0.5549,  0.5244,  0.6358, -0.0464,  0.5940,  0.8915,  1.0292,
         1.2930,  0.5031,  0.3936,  0.8068,  0.1120, -0.0419,  3.0682],
       device='cuda:0')
Likelihood: -179.29428100585938
State is out of distribution
Likelihoods: tensor([-4.9527, -4.9761, -5.1053, -5.1975, -5.2387, -5.3328, -5.5933, -5.6903,
        -5.7047, -5.7939, -5.8247, -5.9285, -6.1060, -6.1192, -6.2760, -6.5090],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.003911974962596895}
Likelihood grouped sum: {'thumb_middle': 0.06259159940155032}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.8286995289381593
Current yaw: tensor([ 0.1227, -0.0403,  3.0633], device='cuda:0')
4 thumb_middle
tensor([ 0.0057,  0.5556,  0.5241,  0.6357, -0.0464,  0.5942,  0.8926,  1.0307,
         1.2928,  0.5029,  0.3935,  0.8067,  0.1230, -0.0371,  3.0638],
       device='cuda:0')
Solve time for step 1 (global step 13) 3.9645996839972213
Current ori: tensor([ 0.1224, -0.0434,  3.0658], device='cuda:0')
Index force: tensor([1.1379, 0.9955, 0.9567], device='cuda:0')
tensor([ 0.1224, -0.0434,  3.0658], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([-0.0464,  0.5327,  0.6294,  0.6358, -0.1895,  0.5143,  0.8546,  0.9318,
         1.2307,  0.4060,  0.3032,  0.9212,  1.6561, -0.6168, -2.2144],
       device='cuda:0')
Solve time for step 2 (global step 14) 3.756478987983428
Current ori: tensor([ 1.6631, -0.6160, -2.2134], device='cuda:0')
Index force: tensor([0.9979, 0.9841], device='cuda:0')
tensor([ 1.6631, -0.6160, -2.2134], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([-0.1548,  0.8487,  0.7065,  0.7143, -0.1823,  0.6202,  0.8684,  0.8899,
         1.2270,  0.4061,  0.2726,  0.9350,  1.6639, -0.6148, -2.2131],
       device='cuda:0')
Solve time for step 3 (global step 15) 3.453539388952777
Current ori: tensor([ 1.6644, -0.6142, -2.2120], device='cuda:0')
Index force: tensor([1.0085], device='cuda:0')
tensor([ 1.6644, -0.6142, -2.2120], device='cuda:0')
Probably dropped the object
tensor([ 1.6592, -0.6191, -2.2139], device='cuda:0')
Likelihood: -676.7192993164062
State is out of distribution
{}

Trial 2
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([ 1.2488, -1.0628, -1.6235], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([ 0.0136, -0.0148, -2.7749], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0205, -0.0163, -2.7859], device='cuda:0')
1 turn
Likelihood: -94.85887145996094
Sampling time 3.1829427579650655
tensor([ 0.1463,  0.5278,  0.6507,  0.6746, -0.0844,  0.5535,  0.8825,  0.8376,
         1.2018,  0.2719,  0.2821,  1.1585, -0.0202, -0.0119, -2.7892],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.27487385191489
Current ori: tensor([-0.0192, -0.0127, -2.7882], device='cuda:0')
Middle force: tensor([0.9427, 1.9733, 0.9566, 2.1374, 1.7477, 1.1277, 1.5958, 1.0050, 0.9960,
        0.9928, 0.9754, 1.0393], device='cuda:0')
Thumb force: tensor([2.3247, 1.6714, 0.9986, 1.1786, 1.7360, 1.4860, 0.9549, 1.3688, 0.9777,
        1.4021, 1.0016, 1.2741], device='cuda:0')
Index force: tensor([1.4670, 1.0075, 1.0199, 0.9699, 1.0394, 0.9660, 1.0115, 0.9183, 1.1377,
        1.1361, 1.0355, 1.0093], device='cuda:0')
tensor([-0.0192, -0.0127, -2.7882], device='cuda:0')
tensor([ 0.1443,  0.5383,  0.6409,  0.6711, -0.0899,  0.5362,  0.9054,  0.8843,
         1.2460,  0.2294,  0.3084,  1.0694, -0.0205, -0.0128, -2.9143],
       device='cuda:0')
Likelihood: -77.0291748046875
Solve time for step 2 (global step 1) 7.658673856058158
Current ori: tensor([-0.0218, -0.0124, -2.9110], device='cuda:0')
Middle force: tensor([1.9891, 1.0152, 2.0918, 1.6621, 1.1121, 1.5327, 1.0018, 1.0000, 0.9999,
        1.0071, 1.0259], device='cuda:0')
Thumb force: tensor([1.6107, 1.0000, 1.1444, 1.7031, 1.4481, 1.0154, 1.3338, 1.0084, 1.3838,
        0.9999, 1.2589], device='cuda:0')
Index force: tensor([1.0048, 1.0261, 1.0166, 1.0308, 1.0164, 1.0066, 1.0345, 1.1350, 1.1155,
        1.0264, 1.0043], device='cuda:0')
tensor([-0.0218, -0.0124, -2.9110], device='cuda:0')
tensor([ 1.4225e-01,  5.5292e-01,  6.2035e-01,  6.5913e-01, -9.4108e-02,
         5.0688e-01,  9.4940e-01,  9.2410e-01,  1.3249e+00,  1.3658e-01,
         3.0243e-01,  9.1816e-01, -2.9077e-02, -2.8204e-03,  3.1084e+00],
       device='cuda:0')
Likelihood: -108.81475830078125
Solve time for step 3 (global step 2) 7.326688252040185
Current ori: tensor([-0.0292, -0.0033,  3.1079], device='cuda:0')
Middle force: tensor([1.0012, 1.0604, 2.0448, 1.3653, 2.2422, 1.0521, 1.0080, 1.0142, 1.0259,
        1.0072], device='cuda:0')
Thumb force: tensor([1.0275, 1.0706, 1.0001, 1.2142, 1.5868, 1.0124, 1.0000, 1.0057, 1.0662,
        1.0189], device='cuda:0')
Index force: tensor([1.0002, 1.0249, 1.0107, 1.0191, 1.0145, 1.0138, 1.0269, 1.0248, 1.0131,
        1.3253], device='cuda:0')
tensor([-0.0292, -0.0033,  3.1079], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.1184,  0.5500,  0.5942,  0.6636, -0.0949,  0.5513,  0.9672,  0.9486,
         1.3109,  0.1482,  0.2974,  0.8550, -0.0066, -0.0310,  2.9132],
       device='cuda:0')
Likelihood: -126.21449279785156
Solve time for step 4 (global step 3) 6.843100414029323
Current ori: tensor([-0.0055, -0.0296,  2.9114], device='cuda:0')
Middle force: tensor([1.0003, 1.0052, 1.0168, 1.0385, 1.0223, 1.0003, 1.8393, 1.0097, 1.4714],
       device='cuda:0')
Thumb force: tensor([1.0007, 1.0023, 1.0003, 1.0039, 1.0094, 1.3966, 1.0015, 1.0038, 1.2020],
       device='cuda:0')
Index force: tensor([1.1550, 1.0161, 1.0089, 1.0172, 1.0199, 1.0165, 1.0016, 1.0202, 1.0093],
       device='cuda:0')
tensor([-0.0055, -0.0296,  2.9114], device='cuda:0')
tensor([ 0.1132,  0.5319,  0.6115,  0.6645, -0.0900,  0.5511,  0.9529,  0.9759,
         1.2604,  0.2351,  0.3093,  0.8788, -0.0041, -0.0301,  2.9734],
       device='cuda:0')
Likelihood: -112.44818878173828
Solve time for step 5 (global step 4) 6.30594565498177
Current ori: tensor([ 1.7795e-03, -2.5872e-02,  2.9727e+00], device='cuda:0')
Middle force: tensor([1.0059, 1.0170, 1.5608, 1.0521, 1.3397, 1.7156, 1.1033, 1.0182],
       device='cuda:0')
Thumb force: tensor([1.0911, 1.0003, 1.3593, 1.1317, 1.0138, 2.0012, 1.4718, 1.0003],
       device='cuda:0')
Index force: tensor([1.0879, 1.0002, 1.0331, 1.0001, 1.0006, 1.0262, 1.0071, 1.0001],
       device='cuda:0')
tensor([ 1.7795e-03, -2.5872e-02,  2.9727e+00], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 9.8190e-02,  5.5765e-01,  5.8143e-01,  6.2522e-01, -8.9555e-02,
         5.5047e-01,  9.5244e-01,  9.6300e-01,  1.3570e+00,  1.2004e-01,
         3.2046e-01,  7.7404e-01,  8.7297e-04, -3.3553e-02, -3.0775e+00],
       device='cuda:0')
Likelihood: -157.37539672851562
Solve time for step 6 (global step 5) 6.010973497061059
Current ori: tensor([ 2.7467e-03, -3.5018e-02, -3.0724e+00], device='cuda:0')
Middle force: tensor([1.0016, 1.0009, 1.0002, 1.1608, 1.1227, 1.3298, 1.0003],
       device='cuda:0')
Thumb force: tensor([1.0040, 1.0007, 1.1793, 1.0006, 1.0005, 1.8522, 1.0855],
       device='cuda:0')
Index force: tensor([1.0041, 1.0054, 1.0048, 1.0066, 1.0022, 1.0000, 1.0031],
       device='cuda:0')
tensor([ 2.7467e-03, -3.5018e-02, -3.0724e+00], device='cuda:0')
tensor([ 0.0973,  0.5932,  0.5584,  0.5685, -0.0921,  0.6173,  0.9086,  0.8588,
         1.3567,  0.0888,  0.2582,  0.9535,  0.0317, -0.0302, -2.7772],
       device='cuda:0')
Likelihood: -122.21076202392578
Solve time for step 7 (global step 6) 5.637526722042821
Current ori: tensor([ 0.0297, -0.0305, -2.7809], device='cuda:0')
Middle force: tensor([1.0002, 1.0002, 1.2141, 1.1100, 1.3400, 0.9996], device='cuda:0')
Thumb force: tensor([1.0006, 1.2047, 1.0005, 1.0001, 1.7736, 1.0710], device='cuda:0')
Index force: tensor([1.0032, 1.0049, 1.0051, 1.0004, 1.0004, 1.0023], device='cuda:0')
tensor([ 0.0297, -0.0305, -2.7809], device='cuda:0')
tensor([ 0.0982,  0.6159,  0.5477,  0.5352, -0.0845,  0.7202,  0.8124,  0.7594,
         1.2338,  0.2475,  0.2397,  1.1634,  0.0224, -0.0125, -2.3860],
       device='cuda:0')
Likelihood: -75.75837707519531
Solve time for step 8 (global step 7) 5.499838136951439
Current ori: tensor([ 0.0207, -0.0105, -2.3869], device='cuda:0')
Middle force: tensor([1.0064, 1.0019, 1.0062, 1.0286, 1.0035], device='cuda:0')
Thumb force: tensor([1.0003, 1.4332, 1.0006, 1.1262, 1.0004], device='cuda:0')
Index force: tensor([1.0003, 1.0013, 1.0016, 1.0034, 1.0190], device='cuda:0')
tensor([ 0.0207, -0.0105, -2.3869], device='cuda:0')
tensor([ 0.0990,  0.6250,  0.5328,  0.5330, -0.0845,  0.7261,  0.7965,  0.7663,
         1.2341,  0.2786,  0.2533,  1.0975,  0.0144, -0.0081, -2.4442],
       device='cuda:0')
Likelihood: -101.67144775390625
Solve time for step 9 (global step 8) 5.236432056990452
Current ori: tensor([ 0.0178, -0.0093, -2.4394], device='cuda:0')
Middle force: tensor([1.0018, 1.0046, 1.0273, 1.0022], device='cuda:0')
Thumb force: tensor([1.4480, 1.0015, 1.1202, 1.0002], device='cuda:0')
Index force: tensor([1.0008, 1.0011, 1.0027, 1.0157], device='cuda:0')
tensor([ 0.0178, -0.0093, -2.4394], device='cuda:0')
tensor([ 0.1115,  0.6429,  0.5307,  0.5168, -0.0811,  0.6938,  0.8307,  0.8200,
         1.3082,  0.2092,  0.2596,  0.9325,  0.0175, -0.0373, -2.6090],
       device='cuda:0')
Likelihood: -122.91635131835938
Solve time for step 10 (global step 9) 4.927131840027869
Current ori: tensor([ 0.0176, -0.0372, -2.6097], device='cuda:0')
Middle force: tensor([1.0036, 1.0302, 1.0019], device='cuda:0')
Thumb force: tensor([1.0017, 1.1122, 1.0005], device='cuda:0')
Index force: tensor([1.0008, 1.0022, 1.0134], device='cuda:0')
tensor([ 0.0176, -0.0372, -2.6097], device='cuda:0')
tensor([ 0.1327,  0.6649,  0.5268,  0.5167, -0.0700,  0.7273,  0.8198,  0.8126,
         1.2151,  0.3960,  0.2931,  0.9165,  0.0172, -0.0397, -2.6077],
       device='cuda:0')
Likelihood: -146.110107421875
Solve time for step 11 (global step 10) 4.50420748302713
Current ori: tensor([ 0.0174, -0.0382, -2.6086], device='cuda:0')
Middle force: tensor([1.0248, 1.0010], device='cuda:0')
Thumb force: tensor([1.1100, 1.0005], device='cuda:0')
Index force: tensor([1.0018, 1.0137], device='cuda:0')
tensor([ 0.0174, -0.0382, -2.6086], device='cuda:0')
tensor([ 0.1526,  0.6287,  0.5730,  0.5613, -0.0693,  0.6613,  0.8856,  0.9038,
         1.3226,  0.2270,  0.2661,  0.8414,  0.0373, -0.0527, -2.7825],
       device='cuda:0')
Likelihood: -141.96815490722656
Solve time for step 12 (global step 11) 4.286155337002128
Current ori: tensor([ 0.0390, -0.0538, -2.7820], device='cuda:0')
Middle force: tensor([1.0007], device='cuda:0')
Thumb force: tensor([1.0003], device='cuda:0')
Index force: tensor([1.0120], device='cuda:0')
tensor([ 0.0390, -0.0538, -2.7820], device='cuda:0')
Current yaw: tensor([ 0.0410, -0.0613, -2.8142], device='cuda:0')
2 turn
Likelihood: -139.85186767578125
Sampling time 3.2947557050501928
tensor([ 0.1643,  0.6395,  0.5752,  0.5616, -0.0662,  0.6687,  0.8951,  0.9162,
         1.3114,  0.2487,  0.2646,  0.8335,  0.0431, -0.0616, -2.8148],
       device='cuda:0')
Solve time for step 1 (global step 12) 8.318964970996603
Current ori: tensor([ 0.0427, -0.0614, -2.8149], device='cuda:0')
Middle force: tensor([1.5112, 1.5877, 1.0273, 1.0401, 0.9711, 1.2905, 1.0500, 1.0351, 1.4435,
        1.0680, 1.0600, 1.0914], device='cuda:0')
Thumb force: tensor([1.4521, 3.3040, 1.6669, 1.0255, 1.7594, 1.0461, 0.9558, 1.2544, 1.0178,
        0.9662, 1.0250, 0.9158], device='cuda:0')
Index force: tensor([1.0199, 1.0209, 1.4352, 0.9871, 1.0342, 0.9571, 0.9978, 1.0125, 0.9983,
        0.9969, 1.0266, 0.9848], device='cuda:0')
tensor([ 0.0427, -0.0614, -2.8149], device='cuda:0')
tensor([ 0.1441,  0.6208,  0.5709,  0.5745, -0.0702,  0.6817,  0.8517,  0.9062,
         1.2654,  0.3201,  0.2809,  0.9175,  0.0289, -0.0396, -2.6588],
       device='cuda:0')
Likelihood: -133.49830627441406
Solve time for step 2 (global step 13) 7.686460338067263
Current ori: tensor([ 0.0293, -0.0405, -2.6560], device='cuda:0')
Middle force: tensor([1.5807, 1.0404, 1.0377, 1.0188, 1.2848, 1.0534, 1.0337, 1.4058, 1.0634,
        1.0606, 1.1035], device='cuda:0')
Thumb force: tensor([3.1974, 1.5812, 1.0214, 1.7239, 1.0458, 1.0226, 1.2302, 1.0174, 1.0200,
        1.0199, 1.0302], device='cuda:0')
Index force: tensor([1.0170, 1.3607, 1.0081, 1.0293, 1.0258, 1.0013, 1.0105, 1.0010, 1.0019,
        1.0230, 1.0110], device='cuda:0')
tensor([ 0.0293, -0.0405, -2.6560], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1394,  0.6361,  0.5447,  0.5622, -0.0636,  0.6956,  0.8695,  0.9194,
         1.3396,  0.2078,  0.3130,  0.7975,  0.0672, -0.0483, -2.6710],
       device='cuda:0')
Likelihood: -169.69906616210938
Solve time for step 3 (global step 14) 7.5613784219603986
Current ori: tensor([ 0.0669, -0.0478, -2.6707], device='cuda:0')
Middle force: tensor([1.0032, 1.2820, 1.0239, 1.0245, 1.0132, 1.0529, 1.4501, 1.5877, 1.3918,
        1.4719], device='cuda:0')
Thumb force: tensor([1.4140, 1.2244, 1.0115, 1.0326, 1.0474, 1.1318, 1.0265, 1.2177, 1.0157,
        1.0019], device='cuda:0')
Index force: tensor([1.2502, 1.0998, 1.0412, 1.0470, 1.0381, 1.0023, 1.0362, 1.0143, 1.0192,
        1.0199], device='cuda:0')
tensor([ 0.0679, -0.0495, -2.6698], device='cuda:0')
tensor([ 0.1372,  0.6146,  0.5588,  0.5680, -0.0636,  0.6963,  0.8700,  0.8892,
         1.3355,  0.1924,  0.2943,  0.9012,  0.0713, -0.0353, -2.5364],
       device='cuda:0')
Likelihood: -162.51004028320312
Solve time for step 4 (global step 15) 6.799953398993239
Current ori: tensor([ 0.0687, -0.0269, -2.5390], device='cuda:0')
Middle force: tensor([1.2773, 1.0284, 1.0209, 1.0110, 1.0486, 1.4133, 1.5595, 1.3760, 1.4431],
       device='cuda:0')
Thumb force: tensor([1.2380, 1.0106, 1.0287, 1.0462, 1.1243, 1.0259, 1.2066, 1.0137, 1.0011],
       device='cuda:0')
Index force: tensor([1.0770, 1.0365, 1.0457, 1.0354, 1.0017, 1.0348, 1.0130, 1.0167, 1.0186],
       device='cuda:0')
tensor([ 0.0687, -0.0269, -2.5390], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1336,  0.6452,  0.5724,  0.5687, -0.0644,  0.7306,  0.8789,  0.8564,
         1.3417,  0.2114,  0.3033,  0.8684,  1.6690, -0.5236, -2.1964],
       device='cuda:0')
Likelihood: -509.56524658203125
State is out of distribution
Probably dropped the object
tensor([ 1.6632, -0.5160, -2.2150], device='cuda:0')
{}

Trial 3
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([ 1.6742, -0.5128, -2.1995], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.