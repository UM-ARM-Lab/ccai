Hardware mode
Datetime: .04.26.25:02:50:16
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-0.0218,  0.0366,  0.2530], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0339,  0.0380,  0.2195], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0044,  0.0358,  0.1136], device='cuda:0')
1 turn
Likelihood: -57.93288803100586
Sampling time 3.3257667949656025
tensor([ 0.1319,  0.5644,  0.6273,  0.6164, -0.0881,  0.5480,  0.8771,  0.8763,
         1.1757,  0.3254,  0.2743,  1.2526, -0.0063,  0.0361,  0.1121],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.191504221991636
Current ori: tensor([-0.0064,  0.0390,  0.1110], device='cuda:0')
Middle force: tensor([0.5150, 1.4264, 0.6622, 1.4283, 1.3731, 0.6131, 0.9485, 0.6780, 0.5664,
        0.9144, 0.8304, 0.5295], device='cuda:0')
Thumb force: tensor([0.9224, 0.9587, 1.6220, 1.4287, 1.7010, 1.2861, 1.1831, 0.9078, 1.4596,
        2.2150, 0.7738, 0.6942], device='cuda:0')
Index force: tensor([1.2683, 0.8898, 0.7492, 0.5069, 0.5514, 1.1610, 0.5254, 0.9253, 1.4186,
        0.5288, 0.9885, 0.5189], device='cuda:0')
tensor([-0.0056,  0.0369,  0.1154], device='cuda:0')
tensor([ 0.1291,  0.6160,  0.5811,  0.5686, -0.0907,  0.5483,  0.8673,  0.8764,
         1.2481,  0.2400,  0.2613,  1.1607, -0.0202,  0.0319, -0.0126],
       device='cuda:0')
Likelihood: -54.45489501953125
Solve time for step 2 (global step 1) 7.767760570975952
Current ori: tensor([-0.0113,  0.0318, -0.0126], device='cuda:0')
Middle force: tensor([0.5036, 1.7084, 0.9641, 0.5452, 0.5163, 2.2995, 1.1962, 0.5156, 1.3548,
        0.9494, 0.5131], device='cuda:0')
Thumb force: tensor([0.5339, 2.4452, 1.7555, 0.8490, 2.1868, 1.8091, 0.8132, 0.8694, 1.3456,
        1.5448, 1.2582], device='cuda:0')
Index force: tensor([1.3009, 0.6438, 0.5959, 1.2323, 0.6034, 1.3547, 0.5410, 0.6978, 0.5156,
        0.5057, 0.8519], device='cuda:0')
tensor([-0.0113,  0.0318, -0.0126], device='cuda:0')
tensor([ 0.1333,  0.6210,  0.5809,  0.5686, -0.0882,  0.5486,  0.8529,  0.9057,
         1.2688,  0.2145,  0.2534,  1.1271, -0.0198,  0.0302, -0.0994],
       device='cuda:0')
Likelihood: -64.52645111083984
Solve time for step 3 (global step 2) 7.265772093087435
Current ori: tensor([-0.0192,  0.0299, -0.1000], device='cuda:0')
Middle force: tensor([1.7304, 0.9779, 0.5386, 0.5125, 2.2976, 0.5035, 1.4710, 0.5657, 0.7124,
        0.7677], device='cuda:0')
Thumb force: tensor([2.3486, 1.6986, 0.8551, 2.1043, 1.7684, 1.2842, 1.4758, 1.2784, 0.8682,
        0.5181], device='cuda:0')
Index force: tensor([0.6463, 0.6077, 1.2433, 0.5954, 1.3427, 0.8914, 0.5022, 0.5120, 0.7085,
        0.6278], device='cuda:0')
tensor([-0.0192,  0.0299, -0.1000], device='cuda:0')
tensor([ 0.1343,  0.6349,  0.5689,  0.5468, -0.0928,  0.5200,  0.8623,  0.9762,
         1.3165,  0.1840,  0.2852,  0.9826, -0.0103,  0.0255, -0.3233],
       device='cuda:0')
Likelihood: -86.8374252319336
Solve time for step 4 (global step 3) 6.876536505995318
Current ori: tensor([-0.0185,  0.0295, -0.3236], device='cuda:0')
Middle force: tensor([0.9635, 0.5357, 0.5111, 2.2305, 0.5031, 1.4448, 0.5595, 0.7036, 0.7576],
       device='cuda:0')
Thumb force: tensor([1.6455, 0.8342, 2.0438, 1.7203, 1.2472, 1.4341, 1.2472, 0.8456, 0.5160],
       device='cuda:0')
Index force: tensor([0.6019, 1.2175, 0.5885, 1.3053, 0.8766, 0.5018, 0.5112, 0.7001, 0.6207],
       device='cuda:0')
tensor([-0.0185,  0.0295, -0.3236], device='cuda:0')
tensor([ 0.1385,  0.6433,  0.5636,  0.5443, -0.0911,  0.4921,  0.8877,  1.0357,
         1.3324,  0.1735,  0.2935,  0.8863, -0.0202,  0.0190, -0.5054],
       device='cuda:0')
Likelihood: -110.96714782714844
Solve time for step 5 (global step 4) 6.600053424015641
Current ori: tensor([-0.0199,  0.0189, -0.5054], device='cuda:0')
Middle force: tensor([0.5349, 0.5104, 2.1744, 0.5029, 1.4212, 0.5553, 0.6952, 0.7488],
       device='cuda:0')
Thumb force: tensor([0.8047, 1.9862, 1.6751, 1.2130, 1.3944, 1.2187, 0.8295, 0.5146],
       device='cuda:0')
Index force: tensor([1.1965, 0.5834, 1.2678, 0.8628, 0.5014, 0.5103, 0.6912, 0.6138],
       device='cuda:0')
tensor([-0.0199,  0.0189, -0.5054], device='cuda:0')
Apply perturbation now. Press <ENTER> to continuetensor([ 1.6066e-01,  6.4778e-01,  5.8114e-01,  5.4218e-01, -8.7661e-02,
         5.0979e-01,  8.9839e-01,  1.0719e+00,  1.3291e+00,  1.7785e-01,
         2.9041e-01,  8.6926e-01,  1.2341e-02, -1.1252e-03, -8.2810e-01],
       device='cuda:0')
Likelihood: -141.9428253173828
Solve time for step 6 (global step 5) 6.008039787993766
Current ori: tensor([ 0.0138, -0.0017, -0.8275], device='cuda:0')
Middle force: tensor([0.5094, 2.1218, 0.5021, 1.3883, 0.5524, 0.6935, 0.7458],
       device='cuda:0')
Thumb force: tensor([1.9254, 1.6288, 1.2036, 1.3734, 1.1878, 0.8058, 0.5129],
       device='cuda:0')
Index force: tensor([0.5779, 1.2246, 0.8500, 0.5011, 0.5096, 0.6835, 0.6063],
       device='cuda:0')
tensor([ 0.0138, -0.0017, -0.8275], device='cuda:0')
Apply perturbation now. Press <ENTER> to continuetensor([ 1.3792e-01,  6.4746e-01,  5.6139e-01,  5.3153e-01, -8.9417e-02,
         5.1001e-01,  8.9786e-01,  1.0704e+00,  1.3533e+00,  1.7068e-01,
         2.9516e-01,  8.1582e-01,  8.7840e-03, -1.7403e-04, -8.8825e-01],
       device='cuda:0')
Likelihood: -147.31024169921875
Solve time for step 7 (global step 6) 5.691232390003279
Current ori: tensor([ 0.0111,  0.0033, -0.8878], device='cuda:0')
Middle force: tensor([2.0669, 0.5020, 1.3625, 0.5494, 0.6908, 0.7392], device='cuda:0')
Thumb force: tensor([1.5807, 1.1662, 1.3393, 1.1612, 0.7860, 0.5117], device='cuda:0')
Index force: tensor([1.1952, 0.8372, 0.5009, 0.5090, 0.6763, 0.6005], device='cuda:0')
tensor([ 0.0111,  0.0031, -0.8876], device='cuda:0')
Apply perturbation now. Press <ENTER> to continuetensor([ 0.1389,  0.6435,  0.5624,  0.5341, -0.0828,  0.5083,  0.9031,  1.0997,
         1.3742,  0.1878,  0.3079,  0.7687,  0.0361, -0.0122, -1.1938],
       device='cuda:0')
Likelihood: -176.13783264160156
State is out of distribution
Likelihoods: tensor([-3.1378, -3.2075, -3.2656, -3.2902, -3.4304, -3.4814, -3.5831, -3.8288,
        -3.8892, -4.0056, -4.0673, -4.1826, -4.2527, -4.3004, -4.3032, -4.4544],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.02474516253397776}
Likelihood grouped sum: {'thumb_middle': 0.39592260054364414}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.890795974060893
Current yaw: tensor([ 0.0340, -0.0121, -1.1957], device='cuda:0')
2 thumb_middle
tensor([ 0.1386,  0.6432,  0.5625,  0.5340, -0.0830,  0.5075,  0.9047,  1.0996,
         1.3745,  0.1878,  0.3080,  0.7685,  0.0364, -0.0132, -1.1943],
       device='cuda:0')
Solve time for step 1 (global step 7) 3.8636342349927872
Current ori: tensor([ 0.0359, -0.0114, -1.1951], device='cuda:0')
Index force: tensor([0.5928, 0.5625, 0.5571], device='cuda:0')
tensor([ 0.0359, -0.0114, -1.1951], device='cuda:0')
tensor([ 0.1147,  0.6759,  0.5012,  0.5145, -0.1845,  0.4636,  0.8728,  0.9985,
         1.2790,  0.1946,  0.2361,  0.8884,  0.0284, -0.0068, -1.1973],
       device='cuda:0')
Solve time for step 2 (global step 8) 3.665254731080495
Current ori: tensor([ 0.0300, -0.0018, -1.1978], device='cuda:0')
Index force: tensor([0.5609, 0.5550], device='cuda:0')
tensor([ 0.0300, -0.0018, -1.1978], device='cuda:0')
tensor([ 0.1099,  0.7039,  0.4613,  0.4569, -0.1844,  0.4636,  0.8726,  0.9429,
         1.2440,  0.2148,  0.2328,  0.9773,  0.0240, -0.0122, -1.1692],
       device='cuda:0')
Solve time for step 3 (global step 9) 3.366545857046731
Current ori: tensor([ 0.0158, -0.0098, -1.1629], device='cuda:0')
Index force: tensor([0.5561], device='cuda:0')
tensor([ 0.0158, -0.0098, -1.1629], device='cuda:0')
