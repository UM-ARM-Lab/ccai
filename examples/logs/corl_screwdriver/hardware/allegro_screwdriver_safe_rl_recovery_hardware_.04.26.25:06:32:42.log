Hardware mode
Datetime: .04.26.25:06:32:42
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 25, 'visualize': True, 'experiment_name': 'allegro_screwdriver_safe_rl_recovery_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': -1.5, 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': False, 'visualize_contact_plan': False, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'model_path': '/home/abhinav/Documents/ccai/data/training/allegro_screwdriver/safe_rl/safety_critic.pt', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -160.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'device': 'cuda:0', 'recovery_controller': 'mppi', 'OOD_metric': 'q_function', 'lambda_': 0.01, 'q_cutoff': 0.01, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-0.0306,  0.0030,  1.8166], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0186, -0.0090,  1.8321], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0177, -0.0105,  1.8330], device='cuda:0')
1 turn
Sampling time 3.363193102995865
tensor([ 0.1222,  0.5963,  0.5779,  0.6075, -0.0959,  0.4682,  0.9951,  0.9044,
         1.2514,  0.3171,  0.1737,  1.2058, -0.0179, -0.0102,  1.8336],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.153329393011518
Current ori: tensor([-0.0182, -0.0106,  1.8336], device='cuda:0')
Middle force: tensor([1.2078, 2.4803, 0.5178, 0.7843, 0.8556, 1.2588, 1.1063, 1.1768, 1.0512,
        1.8588, 0.9398, 2.2003], device='cuda:0')
Thumb force: tensor([1.0069, 1.7989, 0.7569, 1.5876, 0.7808, 0.5723, 1.3218, 0.7279, 1.6834,
        0.9164, 1.0155, 1.8507], device='cuda:0')
Index force: tensor([1.0859, 1.1206, 0.7178, 0.7081, 0.5238, 0.6390, 0.5664, 0.7860, 0.5984,
        1.1019, 0.5001, 0.5586], device='cuda:0')
Q function output: 0.00
tensor([-0.0181, -0.0110,  1.8336], device='cuda:0')
tensor([ 0.1180,  0.6225,  0.5616,  0.5604, -0.0981,  0.4545,  1.0070,  0.9732,
         1.3081,  0.2863,  0.1936,  1.0356, -0.0329,  0.0128,  1.6142],
       device='cuda:0')
Solve time for step 2 (global step 1) 7.732638556044549
Current ori: tensor([-0.0339,  0.0122,  1.6113], device='cuda:0')
Middle force: tensor([2.3656, 0.5133, 0.7636, 0.8243, 1.2177, 1.0780, 1.1183, 1.0236, 1.7791,
        0.9102, 2.1400], device='cuda:0')
Thumb force: tensor([1.7542, 0.7629, 1.5526, 0.7764, 0.5672, 1.2979, 0.7287, 1.6526, 0.9136,
        0.9949, 1.8077], device='cuda:0')
Index force: tensor([1.1265, 0.7099, 0.6959, 0.5210, 0.6340, 0.5617, 0.7660, 0.5903, 1.0735,
        0.5001, 0.5536], device='cuda:0')
Q function output: 0.00
tensor([-0.0339,  0.0122,  1.6113], device='cuda:0')
tensor([ 0.1334,  0.6371,  0.5598,  0.5475, -0.0729,  0.4398,  0.9989,  1.0691,
         1.3416,  0.2898,  0.2244,  0.8704, -0.0348, -0.0129,  1.3892],
       device='cuda:0')
Solve time for step 3 (global step 2) 7.247727663023397
Current ori: tensor([-0.0126, -0.0174,  1.3882], device='cuda:0')
Middle force: tensor([0.8902, 0.7628, 0.5799, 0.7853, 1.0592, 0.9140, 0.5137, 0.7053, 1.0841,
        1.0173], device='cuda:0')
Thumb force: tensor([0.7343, 1.0325, 0.8477, 0.6644, 0.6901, 1.0285, 0.7262, 0.6210, 0.8185,
        1.3339], device='cuda:0')
Index force: tensor([0.7703, 0.5228, 1.0306, 0.9090, 0.5048, 0.6447, 0.9122, 0.5054, 0.5015,
        0.6404], device='cuda:0')
Q function output: 0.00
tensor([-0.0126, -0.0174,  1.3882], device='cuda:0')
tensor([ 0.1168,  0.6050,  0.5770,  0.5765, -0.1167,  0.4556,  0.9914,  1.0596,
         1.3405,  0.2730,  0.2223,  0.9318, -0.0300, -0.0050,  1.4961],
       device='cuda:0')
Solve time for step 4 (global step 3) 6.818182501010597
Current ori: tensor([-0.0291, -0.0055,  1.4962], device='cuda:0')
Middle force: tensor([0.7396, 0.5699, 0.7582, 1.0343, 0.8999, 0.5084, 0.6912, 1.0625, 0.9722],
       device='cuda:0')
Thumb force: tensor([0.9890, 0.8257, 0.6632, 0.6750, 0.9964, 0.7204, 0.6053, 0.7823, 1.2950],
       device='cuda:0')
Index force: tensor([0.5176, 1.0056, 0.8771, 0.5029, 0.6353, 0.9004, 0.5041, 0.5009, 0.6310],
       device='cuda:0')
Q function output: 0.00
tensor([-0.0291, -0.0055,  1.4962], device='cuda:0')
tensor([ 1.1277e-01,  5.8093e-01,  5.9577e-01,  5.9762e-01, -1.3301e-01,
         4.5519e-01,  9.9607e-01,  1.0737e+00,  1.3566e+00,  2.5785e-01,
         2.1954e-01,  9.2709e-01, -9.0874e-04,  1.9326e-03,  1.4621e+00],
       device='cuda:0')
Solve time for step 5 (global step 4) 6.302221379941329
Current ori: tensor([-6.7112e-04,  3.4770e-03,  1.4604e+00], device='cuda:0')
Middle force: tensor([0.5647, 0.7240, 1.0084, 0.8764, 0.5043, 0.6769, 1.0372, 0.9330],
       device='cuda:0')
Thumb force: tensor([0.8005, 0.6801, 0.6666, 0.9775, 0.7298, 0.5922, 0.7528, 1.2621],
       device='cuda:0')
Index force: tensor([0.9799, 0.8435, 0.5016, 0.6266, 0.8928, 0.5031, 0.5005, 0.6212],
       device='cuda:0')
Q function output: 0.00
tensor([-6.7112e-04,  3.4770e-03,  1.4604e+00], device='cuda:0')
tensor([ 0.1057,  0.5681,  0.6001,  0.6042, -0.1612,  0.4560,  1.0007,  1.0785,
         1.3546,  0.2623,  0.2335,  0.9265, -0.0171,  0.0122,  1.4606],
       device='cuda:0')
Solve time for step 6 (global step 5) 5.970229528029449
Current ori: tensor([-1.1119e-03,  9.3218e-03,  1.4541e+00], device='cuda:0')
Middle force: tensor([0.7036, 0.9919, 0.8647, 0.5022, 0.6637, 1.0139, 0.8978],
       device='cuda:0')
Thumb force: tensor([0.6760, 0.6551, 0.9491, 0.7332, 0.5789, 0.7255, 1.2276],
       device='cuda:0')
Index force: tensor([0.8177, 0.5008, 0.6182, 0.8857, 0.5023, 0.5002, 0.6132],
       device='cuda:0')
Q function output: 0.00
tensor([-1.1119e-03,  9.3218e-03,  1.4541e+00], device='cuda:0')
tensor([ 0.1135,  0.5627,  0.6011,  0.6304, -0.1633,  0.4521,  1.0293,  1.1089,
         1.3558,  0.2630,  0.2526,  0.8698,  0.0052,  0.0032,  1.3671],
       device='cuda:0')
Solve time for step 7 (global step 6) 5.664870322914794
Current ori: tensor([0.0073, 0.0023, 1.3654], device='cuda:0')
Middle force: tensor([0.9692, 0.8540, 0.5013, 0.6520, 0.9939, 0.8712], device='cuda:0')
Thumb force: tensor([0.6443, 0.9228, 0.7180, 0.5667, 0.6987, 1.1881], device='cuda:0')
Index force: tensor([0.5001, 0.6103, 0.8697, 0.5016, 0.5001, 0.6047], device='cuda:0')
Q function output: 0.00
tensor([0.0077, 0.0035, 1.3645], device='cuda:0')
tensor([ 1.2897e-01,  5.5944e-01,  6.1061e-01,  6.5269e-01, -1.6331e-01,
         4.4945e-01,  1.0580e+00,  1.1396e+00,  1.3558e+00,  2.6278e-01,
         2.6742e-01,  8.1865e-01, -1.6558e-02, -3.3219e-04,  1.2928e+00],
       device='cuda:0')
Solve time for step 8 (global step 7) 5.5058559169992805
Current ori: tensor([-1.6288e-02, -7.6077e-04,  1.2919e+00], device='cuda:0')
Middle force: tensor([0.8339, 0.5006, 0.6398, 0.9721, 0.8425], device='cuda:0')
Thumb force: tensor([0.8949, 0.7025, 0.5560, 0.6743, 1.1523], device='cuda:0')
Index force: tensor([0.6007, 0.8569, 0.5009, 0.5000, 0.5955], device='cuda:0')
Q function output: 0.00
tensor([-1.6569e-02, -5.8400e-04,  1.2916e+00], device='cuda:0')
tensor([ 0.1383,  0.5526,  0.6270,  0.6691, -0.1645,  0.4472,  1.0766,  1.1580,
         1.3690,  0.2609,  0.2910,  0.7453, -0.0128, -0.0126,  1.1974],
       device='cuda:0')
Solve time for step 9 (global step 8) 5.418034536996856
Current ori: tensor([-0.0113, -0.0118,  1.1986], device='cuda:0')
Middle force: tensor([0.5002, 0.6297, 0.9534, 0.8226], device='cuda:0')
Thumb force: tensor([0.6766, 0.5486, 0.6543, 1.1143], device='cuda:0')
Index force: tensor([0.8390, 0.5005, 0.5000, 0.5877], device='cuda:0')
Q function output: 0.00
tensor([-0.0113, -0.0118,  1.1986], device='cuda:0')
tensor([ 0.1452,  0.5525,  0.6331,  0.6775, -0.1551,  0.4443,  1.0946,  1.1738,
         1.3706,  0.2615,  0.3147,  0.6814, -0.0110, -0.0151,  1.1530],
       device='cuda:0')
Solve time for step 10 (global step 9) 5.087871124967933
Current ori: tensor([-0.0112, -0.0154,  1.1523], device='cuda:0')
Middle force: tensor([0.8957, 0.5889, 0.5982], device='cuda:0')
Thumb force: tensor([1.1999, 0.9239, 0.8931], device='cuda:0')
Index force: tensor([0.5000, 0.5035, 0.5716], device='cuda:0')
Q function output: 0.00
tensor([-0.0112, -0.0154,  1.1523], device='cuda:0')
tensor([ 0.1445,  0.5589,  0.6314,  0.6611, -0.1543,  0.4399,  1.1186,  1.1860,
         1.4041,  0.2256,  0.3735,  0.4836, -0.0066, -0.0322,  1.0408],
       device='cuda:0')
Solve time for step 11 (global step 10) 4.511765461997129
Current ori: tensor([-0.0792, -0.0132,  1.3778], device='cuda:0')
Middle force: tensor([0.5678, 0.5858], device='cuda:0')
Thumb force: tensor([0.8801, 0.8483], device='cuda:0')
Index force: tensor([0.5020, 0.5620], device='cuda:0')
Q function output: 0.00
tensor([-0.0792, -0.0129,  1.3775], device='cuda:0')
tensor([ 0.1340,  0.5540,  0.6228,  0.6617, -0.1543,  0.4529,  1.1592,  1.1942,
         1.4228,  0.1952,  0.4286,  0.2812, -0.0582, -0.0151,  1.2899],
       device='cuda:0')
Solve time for step 12 (global step 11) 4.307423174963333
Current ori: tensor([-0.0590, -0.0177,  1.2824], device='cuda:0')
Middle force: tensor([0.5733], device='cuda:0')
Thumb force: tensor([0.8091], device='cuda:0')
Index force: tensor([0.5514], device='cuda:0')
Q function output: 0.00
tensor([-0.0590, -0.0177,  1.2824], device='cuda:0')
Current yaw: tensor([-0.0421, -0.0256,  1.2666], device='cuda:0')
2 turn
Sampling time 3.4669296770589426
tensor([ 0.1517,  0.5428,  0.6452,  0.6815, -0.1504,  0.4633,  1.1681,  1.1960,
         1.4485,  0.1661,  0.4548,  0.1409, -0.0423, -0.0252,  1.2666],
       device='cuda:0')
Solve time for step 1 (global step 12) 8.285221608937718
Current ori: tensor([-0.0417, -0.0356,  1.2381], device='cuda:0')
Middle force: tensor([0.9063, 0.6265, 0.8717, 0.7972, 0.5390, 0.7072, 1.2332, 0.6460, 0.5318,
        0.9197, 1.6966, 1.1836], device='cuda:0')
Thumb force: tensor([0.7776, 1.1492, 0.7404, 1.1110, 0.9517, 0.6259, 0.6301, 0.9657, 0.5134,
        0.6334, 0.8441, 1.0069], device='cuda:0')
Index force: tensor([0.6998, 0.6198, 0.7775, 0.5230, 1.0046, 0.8731, 0.5081, 0.7555, 0.8416,
        0.6942, 0.7127, 0.7531], device='cuda:0')
Q function output: 0.00
tensor([-0.0417, -0.0356,  1.2381], device='cuda:0')
tensor([ 0.1649,  0.5340,  0.6657,  0.6960, -0.1296,  0.4937,  1.1494,  1.1552,
         1.4263,  0.1955,  0.2967,  0.4646, -0.0495, -0.0513,  1.4692],
       device='cuda:0')
Solve time for step 2 (global step 13) 7.859788147965446
Current ori: tensor([-0.0482, -0.0511,  1.4700], device='cuda:0')
Middle force: tensor([0.7301, 1.0488, 1.2193, 0.5109, 1.6644, 0.5319, 1.2143, 0.5518, 1.2545,
        0.5787, 0.7356], device='cuda:0')
Thumb force: tensor([1.0026, 0.7682, 2.0617, 1.2267, 2.1940, 1.2036, 0.6866, 0.7533, 0.7236,
        1.0498, 1.0325], device='cuda:0')
Index force: tensor([1.1569, 0.6837, 0.6522, 1.4712, 0.7317, 0.8149, 0.5391, 0.6397, 1.0013,
        0.7881, 0.5000], device='cuda:0')
Q function output: 0.31
OOD detected by Q function: tensor([0.3122], device='cuda:0')
Current yaw: tensor([-0.0487, -0.0511,  1.4702], device='cuda:0')
3 mppi
tensor([ 0.1646,  0.5339,  0.6660,  0.6959, -0.1293,  0.4940,  1.1493,  1.1550,
         1.4267,  0.1961,  0.2966,  0.4647, -0.0489, -0.0517,  1.4694],
       device='cuda:0')
Solve time for step 1 (global step 13) 34.96082738798577
Current ori: tensor([-0.0398, -0.0769,  1.2299], device='cuda:0')
tensor([-0.0398, -0.0769,  1.2299], device='cuda:0')
tensor([ 0.1345,  0.5332,  0.6384,  0.6953, -0.1226,  0.5232,  1.1663,  1.0982,
         1.4379,  0.1986,  0.2134,  0.4414, -0.0562, -0.0910,  1.1740],
       device='cuda:0')
MPPI returned state to ID. Exiting recovery loop
Current yaw: tensor([-0.0568, -0.0901,  1.1718], device='cuda:0')
4 turn
Sampling time 3.45032479101792
tensor([ 0.1344,  0.5334,  0.6384,  0.6954, -0.1226,  0.5233,  1.1667,  1.0986,
         1.4379,  0.1987,  0.2134,  0.4414, -0.0571, -0.0902,  1.1711],
       device='cuda:0')
Solve time for step 1 (global step 14) 8.283084062044509
Current ori: tensor([-0.0568, -0.0909,  1.1716], device='cuda:0')
Middle force: tensor([1.1125, 1.1596, 2.6681, 1.5224, 1.6411, 1.1349, 2.2933, 1.0658, 1.2332,
        1.1986, 1.4618, 0.8142], device='cuda:0')
Thumb force: tensor([0.5242, 1.2727, 0.9790, 1.4597, 0.5191, 0.8499, 1.0424, 1.0705, 0.7100,
        0.9265, 0.7697, 0.7307], device='cuda:0')
Index force: tensor([0.7711, 0.6870, 1.3131, 0.6540, 0.8906, 0.7945, 0.9845, 0.6525, 0.7668,
        0.6451, 0.6073, 0.6189], device='cuda:0')
Q function output: 1.00
OOD detected by Q function: tensor([0.9963], device='cuda:0')
Current yaw: tensor([-0.0573, -0.0907,  1.1713], device='cuda:0')
5 mppi
tensor([ 0.1343,  0.5332,  0.6384,  0.6954, -0.1226,  0.5234,  1.1669,  1.0987,
         1.4378,  0.1986,  0.2132,  0.4413, -0.0566, -0.0910,  1.1716],
       device='cuda:0')
Solve time for step 1 (global step 14) 34.66997055802494
Current ori: tensor([-0.0575, -0.0904,  1.1706], device='cuda:0')
tensor([-0.0570, -0.0901,  1.1711], device='cuda:0')
tensor([ 0.1076,  0.5336,  0.6059,  0.6773, -0.1913,  0.5148,  1.1676,  1.0579,
         1.4128,  0.1984,  0.2156,  0.4878, -0.0365, -0.0360,  0.9410],
       device='cuda:0')
MPPI returned state to ID. Exiting recovery loop
Current yaw: tensor([-0.0347, -0.0184,  0.8633], device='cuda:0')
6 turn
Sampling time 3.334362794063054
tensor([ 0.1076,  0.5337,  0.6057,  0.6771, -0.1915,  0.5151,  1.1676,  1.0566,
         1.4103,  0.1985,  0.2165,  0.4880, -0.0656, -0.0187,  0.6835],
       device='cuda:0')
Solve time for step 1 (global step 15) 8.301978938980028
Current ori: tensor([-0.0703, -0.0130,  0.6825], device='cuda:0')
Middle force: tensor([0.8276, 0.8989, 1.2292, 1.2145, 1.3484, 0.9499, 1.2540, 0.9580, 0.7558,
        1.0266, 1.2237, 1.3087], device='cuda:0')
Thumb force: tensor([0.7373, 1.1217, 0.7901, 0.5268, 0.6735, 0.5566, 1.9535, 1.1036, 0.8276,
        0.6786, 0.8354, 0.8636], device='cuda:0')
Index force: tensor([0.9160, 0.6643, 0.5476, 0.6317, 0.6827, 0.5547, 0.7473, 0.6875, 0.6969,
        0.6631, 0.5412, 0.6024], device='cuda:0')
Q function output: 0.18
OOD detected by Q function: tensor([0.1789], device='cuda:0')
Current yaw: tensor([-0.0697, -0.0123,  0.6827], device='cuda:0')
7 mppi
tensor([ 0.1076,  0.5336,  0.6054,  0.6771, -0.1915,  0.5152,  1.1676,  1.0565,
         1.4096,  0.1985,  0.2165,  0.4879, -0.0658, -0.0197,  0.6832],
       device='cuda:0')
Solve time for step 1 (global step 15) 35.2146618909901
Current ori: tensor([-0.0711, -0.0122,  0.6829], device='cuda:0')
tensor([-0.0711, -0.0122,  0.6829], device='cuda:0')
tensor([ 0.1461,  0.5128,  0.6199,  0.7479, -0.1933,  0.5274,  1.1571,  1.0621,
         1.5031,  0.1652,  0.2146,  0.4731, -0.0797, -0.0112,  0.6742],
       device='cuda:0')
MPPI returned state to ID. Exiting recovery loop
Current yaw: tensor([-0.0803, -0.0111,  0.6744], device='cuda:0')
8 turn
Sampling time 3.372505965991877
tensor([ 0.1462,  0.5128,  0.6204,  0.7479, -0.1930,  0.5273,  1.1571,  1.0613,
         1.5034,  0.1650,  0.2147,  0.4731, -0.0796, -0.0125,  0.6746],
       device='cuda:0')
Solve time for step 1 (global step 16) 8.330674645025283
Current ori: tensor([-0.0801, -0.0103,  0.6736], device='cuda:0')
Middle force: tensor([1.0665, 0.8352, 0.9325, 1.2526, 1.5748, 0.8368, 1.8940, 1.4656, 0.6435,
        0.9238, 1.4731, 1.3711], device='cuda:0')
Thumb force: tensor([1.2729, 0.9676, 0.7808, 1.6674, 1.6712, 1.5030, 1.9511, 0.9938, 2.1217,
        2.3315, 0.5533, 0.9879], device='cuda:0')
Index force: tensor([0.8777, 0.7966, 0.7995, 0.9309, 0.6763, 1.0237, 0.8551, 0.7113, 0.7257,
        0.5165, 0.7619, 0.6422], device='cuda:0')
Q function output: 0.99
OOD detected by Q function: tensor([0.9931], device='cuda:0')
Current yaw: tensor([-0.0799, -0.0116,  0.6736], device='cuda:0')
9 mppi
tensor([ 0.1464,  0.5127,  0.6205,  0.7480, -0.1930,  0.5273,  1.1572,  1.0615,
         1.5036,  0.1651,  0.2146,  0.4729, -0.0802, -0.0112,  0.6737],
       device='cuda:0')
Solve time for step 1 (global step 16) 34.16366762307007
Current ori: tensor([-0.0818, -0.0101,  0.6721], device='cuda:0')
tensor([-0.0818, -0.0101,  0.6721], device='cuda:0')
tensor([ 0.1904,  0.5327,  0.6203,  0.6701, -0.1946,  0.4813,  1.2011,  1.0724,
         1.5262,  0.1169,  0.2333,  0.4705, -0.0738, -0.0103,  0.6425],
       device='cuda:0')
MPPI returned state to ID. Exiting recovery loop
Current yaw: tensor([-0.0824, -0.0100,  0.6510], device='cuda:0')
10 turn
Sampling time 3.3020076350076124
tensor([ 0.1904,  0.5325,  0.6203,  0.6700, -0.1947,  0.4812,  1.2012,  1.0726,
         1.5265,  0.1168,  0.2339,  0.4700, -0.0814, -0.0095,  0.6504],
       device='cuda:0')
Solve time for step 1 (global step 17) 8.464435201953165
Current ori: tensor([-0.0809, -0.0109,  0.6511], device='cuda:0')
Middle force: tensor([0.9935, 0.5717, 0.9346, 1.6369, 2.1593, 0.6800, 0.5007, 0.5208, 1.8086,
        0.6079, 1.2280, 0.8810], device='cuda:0')
Thumb force: tensor([0.8833, 1.6381, 0.7447, 1.4380, 1.4752, 0.5208, 1.5061, 0.8876, 1.2440,
        1.7922, 0.6342, 1.1464], device='cuda:0')
Index force: tensor([0.6480, 0.8916, 0.5990, 1.0674, 1.3701, 0.7428, 0.8273, 0.5934, 0.7728,
        0.7805, 0.8043, 0.7667], device='cuda:0')
Q function output: 0.99
OOD detected by Q function: tensor([0.9879], device='cuda:0')
Current yaw: tensor([-0.0807, -0.0116,  0.6511], device='cuda:0')
11 mppi
tensor([ 0.1901,  0.5326,  0.6204,  0.6697, -0.1948,  0.4812,  1.2013,  1.0727,
         1.5265,  0.1167,  0.2339,  0.4700, -0.0816, -0.0097,  0.6505],
       device='cuda:0')
Solve time for step 1 (global step 17) 33.94141572690569
Current ori: tensor([-0.0733, -0.0118,  0.6428], device='cuda:0')
tensor([-0.0733, -0.0118,  0.6428], device='cuda:0')
tensor([ 0.1890,  0.5516,  0.6198,  0.6694, -0.1953,  0.4812,  1.2070,  1.0293,
         1.5266,  0.1165,  0.2194,  0.4783, -0.0806, -0.0079,  0.6880],
       device='cuda:0')
MPPI returned state to ID. Exiting recovery loop
Current yaw: tensor([-0.0818, -0.0065,  0.6875], device='cuda:0')
12 turn
Sampling time 3.365134937921539
tensor([ 0.1890,  0.5517,  0.6197,  0.6695, -0.1952,  0.4811,  1.2071,  1.0293,
         1.5263,  0.1166,  0.2192,  0.4787, -0.0820, -0.0055,  0.6881],
       device='cuda:0')
Solve time for step 1 (global step 18) 8.374387323041447
Current ori: tensor([-0.0815, -0.0057,  0.6877], device='cuda:0')
Middle force: tensor([0.8906, 0.5624, 0.8999, 0.8213, 0.5387, 1.3850, 0.6777, 0.9562, 0.5140,
        1.8387, 0.5116, 0.7727], device='cuda:0')
Thumb force: tensor([0.6842, 1.1793, 0.7720, 1.0707, 0.9701, 1.9137, 0.6093, 0.7335, 1.2592,
        1.8226, 0.5326, 0.6322], device='cuda:0')
Index force: tensor([0.7533, 0.6099, 0.7602, 0.5306, 0.9951, 1.2192, 0.5125, 0.5997, 0.6519,
        0.9241, 1.0777, 0.8483], device='cuda:0')
Q function output: 0.93
OOD detected by Q function: tensor([0.9267], device='cuda:0')
Current yaw: tensor([-0.0796, -0.0094,  0.6888], device='cuda:0')
13 mppi
tensor([ 0.1890,  0.5518,  0.6196,  0.6697, -0.1953,  0.4810,  1.2070,  1.0292,
         1.5264,  0.1166,  0.2193,  0.4786, -0.0819, -0.0064,  0.6882],
       device='cuda:0')
Solve time for step 1 (global step 18) 34.28932571597397
Current ori: tensor([-0.0807, -0.0072,  0.6880], device='cuda:0')
tensor([-0.0807, -0.0072,  0.6880], device='cuda:0')
tensor([ 0.1890,  0.5517,  0.6546,  0.6698, -0.1951,  0.4835,  1.2242,  0.9955,
         1.5215,  0.1375,  0.2177,  0.4802, -0.0820, -0.0109,  0.7008],
       device='cuda:0')
MPPI returned state to ID. Exiting recovery loop
Current yaw: tensor([-0.0809, -0.0133,  0.7015], device='cuda:0')
14 turn
Sampling time 3.410242523998022
tensor([ 0.1892,  0.5517,  0.6546,  0.6699, -0.1948,  0.4835,  1.2245,  0.9954,
         1.5184,  0.1416,  0.2181,  0.4808, -0.0824, -0.0093,  0.7005],
       device='cuda:0')
Solve time for step 1 (global step 19) 8.389052352053113
Current ori: tensor([-0.0820, -0.0122,  0.7012], device='cuda:0')
Middle force: tensor([0.5016, 0.6893, 0.9431, 1.0573, 0.5069, 0.7645, 1.2439, 1.6261, 0.5191,
        1.3958, 1.0876, 0.6557], device='cuda:0')
Thumb force: tensor([0.6619, 0.9999, 0.5873, 1.0302, 1.8275, 1.1743, 1.1625, 1.1866, 0.7063,
        1.0554, 0.8277, 0.8613], device='cuda:0')
Index force: tensor([0.6934, 0.5494, 0.9570, 0.6180, 1.4966, 0.9138, 0.5244, 0.6284, 0.5753,
        0.6542, 0.5767, 0.8123], device='cuda:0')
Q function output: 1.00
OOD detected by Q function: tensor([0.9961], device='cuda:0')
Current yaw: tensor([-0.0803, -0.0126,  0.7007], device='cuda:0')
15 mppi
tensor([ 0.1889,  0.5517,  0.6547,  0.6699, -0.1949,  0.4834,  1.2245,  0.9955,
         1.5187,  0.1417,  0.2178,  0.4807, -0.0818, -0.0117,  0.7006],
       device='cuda:0')
Solve time for step 1 (global step 19) 33.89724435796961
Current ori: tensor([-0.0807, -0.0122,  0.7004], device='cuda:0')
tensor([-0.0807, -0.0122,  0.7004], device='cuda:0')
tensor([ 0.1898,  0.5350,  0.6548,  0.6701, -0.1760,  0.4147,  1.2260,  0.9315,
         1.5183,  0.1279,  0.2195,  0.4705, -0.3659,  0.0644,  1.6483],
       device='cuda:0')
dropped
MPPI returned state to ID. Exiting recovery loop
Probably dropped the object
tensor([-0.3912,  0.0785,  1.6828], device='cuda:0')
{}

Trial 2
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-1.6449, -0.0436,  2.4079], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.shutdown request: [/allegro_hand_node] Reason: new node registered with same name
