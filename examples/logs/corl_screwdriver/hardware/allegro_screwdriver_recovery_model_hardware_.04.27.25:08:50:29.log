Hardware mode
Datetime: .04.27.25:08:50:29
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 50, 'visualize': True, 'experiment_name': 'allegro_screwdriver_recovery_model_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': '-.5', 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': True, 'visualize_contact_plan': True, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': False, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'OOD_metric': 'likelihood', 'recovery_controller': 'csvgd', 'recovery_model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion', 'model_path': 'data/training/allegro_screwdriver/allegro_screwdriver_recovery_pi_2_low_damping_diffusion/allegro_screwdriver_diffusion.pt', 'model_dir': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -170.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'device': 'cuda:0', 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
2048
4 128 4
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-0.0462,  0.0449,  0.2629], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0755,  0.0145,  0.2375], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0276,  0.0221,  0.0526], device='cuda:0')
1 turn
Likelihood: -57.492393493652344
Sampling time 3.34678912605159
tensor([ 0.1546,  0.5961,  0.5974,  0.6121, -0.0946,  0.5262,  0.8909,  0.9499,
         1.2291,  0.2376,  0.2467,  1.2140, -0.0277,  0.0230,  0.0519],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.285224820952863
Current ori: tensor([-0.0278,  0.0235,  0.0526], device='cuda:0')
Middle force: tensor([1.0764, 1.5263, 0.5057, 1.6023, 1.3501, 0.4949, 1.8910, 0.5346, 1.3106,
        1.3957, 0.5108, 0.8692], device='cuda:0')
Thumb force: tensor([1.7035, 1.0887, 2.9564, 2.3315, 1.6399, 1.0482, 1.3438, 1.0947, 1.1321,
        0.7841, 0.6879, 1.0470], device='cuda:0')
Index force: tensor([0.5937, 0.6498, 1.1127, 0.5006, 0.8111, 0.7877, 0.6852, 0.5105, 0.5000,
        0.6033, 0.9517, 0.8458], device='cuda:0')
tensor([-0.0278,  0.0235,  0.0526], device='cuda:0')
tensor([ 0.1532,  0.6200,  0.5839,  0.5742, -0.0956,  0.5286,  0.8791,  0.9781,
         1.2998,  0.1767,  0.2451,  1.0783, -0.0382,  0.0169, -0.1290],
       device='cuda:0')
Likelihood: -61.304443359375
Solve time for step 2 (global step 1) 7.788886939059012
Current ori: tensor([-0.0381,  0.0148, -0.1282], device='cuda:0')
Middle force: tensor([1.4466, 0.5024, 1.5536, 1.3154, 0.5039, 1.8110, 0.5291, 1.2582, 1.3405,
        0.5085, 0.8450], device='cuda:0')
Thumb force: tensor([1.0477, 2.8119, 2.2124, 1.5630, 1.0010, 1.3001, 1.0713, 1.1059, 0.7664,
        0.6699, 1.0104], device='cuda:0')
Index force: tensor([0.6433, 1.1115, 0.5005, 0.7953, 0.7762, 0.6795, 0.5081, 0.5000, 0.5995,
        0.9315, 0.8252], device='cuda:0')
tensor([-0.0381,  0.0148, -0.1282], device='cuda:0')
tensor([ 0.1533,  0.6194,  0.5860,  0.5737, -0.0961,  0.5227,  0.8788,  1.0154,
         1.3453,  0.0955,  0.2412,  1.0403, -0.0361,  0.0216, -0.2002],
       device='cuda:0')
Likelihood: -96.23206329345703
Solve time for step 3 (global step 2) 7.4066195850027725
Current ori: tensor([-0.0364,  0.0209, -0.1989], device='cuda:0')
Middle force: tensor([0.5017, 1.5124, 1.2823, 0.5031, 1.7458, 0.5250, 1.2145, 1.2973, 0.5061,
        0.8226], device='cuda:0')
Thumb force: tensor([2.6646, 2.1013, 1.4916, 0.9755, 1.2547, 1.0425, 1.0792, 0.7484, 0.6601,
        0.9802], device='cuda:0')
Index force: tensor([1.0977, 0.5004, 0.7773, 0.7620, 0.6726, 0.5065, 0.5000, 0.5935, 0.9148,
        0.8039], device='cuda:0')
tensor([-0.0364,  0.0209, -0.1989], device='cuda:0')
tensor([ 0.1538,  0.6328,  0.5685,  0.5722, -0.0971,  0.5131,  0.8766,  1.0257,
         1.2693,  0.3049,  0.2952,  0.9052, -0.0434,  0.0227, -0.3258],
       device='cuda:0')
Likelihood: -95.76170349121094
Solve time for step 4 (global step 3) 7.00714392203372
Current ori: tensor([-0.0446,  0.0232, -0.3272], device='cuda:0')
Middle force: tensor([1.4556, 1.2633, 0.5270, 0.5730, 1.1782, 0.6406, 0.5473, 1.3516, 1.1517],
       device='cuda:0')
Thumb force: tensor([1.9275, 1.3771, 0.5608, 0.6193, 0.8538, 0.8311, 1.5293, 1.0592, 0.7243],
       device='cuda:0')
Index force: tensor([0.5042, 0.7664, 0.5568, 0.6853, 1.0022, 0.7360, 0.7365, 0.6501, 0.6254],
       device='cuda:0')
tensor([-0.0446,  0.0232, -0.3272], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 1.7034e-01,  6.4506e-01,  5.7202e-01,  5.6376e-01, -9.1849e-02,
         5.0336e-01,  9.0930e-01,  1.0654e+00,  1.3293e+00,  2.3974e-01,
         3.2666e-01,  7.8538e-01,  2.8553e-02, -1.2027e-03, -8.9770e-01],
       device='cuda:0')
Likelihood: -142.08660888671875
Solve time for step 5 (global step 4) 6.4304599040187895
Current ori: tensor([ 2.8777e-02, -7.4631e-04, -8.9553e-01], device='cuda:0')
Middle force: tensor([1.1221, 0.6506, 0.8335, 0.9325, 0.5032, 0.8589, 1.3368, 0.9346],
       device='cuda:0')
Thumb force: tensor([1.2704, 0.9245, 0.6914, 1.1350, 0.6288, 0.5245, 0.8724, 1.2467],
       device='cuda:0')
Index force: tensor([0.7162, 0.6221, 0.8351, 0.8755, 0.6273, 0.5451, 0.6838, 0.5457],
       device='cuda:0')
tensor([ 2.8777e-02, -7.4631e-04, -8.9553e-01], device='cuda:0')
tensor([ 0.1714,  0.6456,  0.5717,  0.5632, -0.0927,  0.5047,  0.9077,  1.0663,
         1.3487,  0.2174,  0.3224,  0.7728,  0.0272,  0.0017, -0.9116],
       device='cuda:0')
Likelihood: -143.00514221191406
Solve time for step 6 (global step 5) 5.906800818978809
Current ori: tensor([ 0.0278,  0.0012, -0.9137], device='cuda:0')
Middle force: tensor([0.8176, 0.7734, 0.9254, 0.7981, 1.1401, 1.2280, 1.4192],
       device='cuda:0')
Thumb force: tensor([1.3713, 0.6388, 1.0585, 0.5333, 0.5022, 0.7832, 1.3452],
       device='cuda:0')
Index force: tensor([0.7813, 0.6114, 0.5262, 0.6083, 0.5779, 0.5271, 0.5634],
       device='cuda:0')
tensor([ 0.0278,  0.0012, -0.9137], device='cuda:0')
tensor([ 1.7092e-01,  6.6565e-01,  5.4752e-01,  5.6195e-01, -9.2524e-02,
         5.0472e-01,  9.0796e-01,  1.0529e+00,  1.3561e+00,  2.0853e-01,
         3.3533e-01,  7.2283e-01,  2.5667e-02,  1.4962e-05, -9.1918e-01],
       device='cuda:0')
Likelihood: -154.83111572265625
Solve time for step 7 (global step 6) 5.626327053993009
Current ori: tensor([ 2.5970e-02, -7.4447e-04, -9.1891e-01], device='cuda:0')
Middle force: tensor([0.7726, 1.0097, 0.7474, 0.5182, 0.7841, 0.5083], device='cuda:0')
Thumb force: tensor([0.6773, 1.1560, 0.5085, 0.6053, 0.7243, 0.5122], device='cuda:0')
Index force: tensor([0.8151, 0.7196, 0.5421, 0.5199, 0.5123, 0.5000], device='cuda:0')
tensor([ 2.5970e-02, -7.4447e-04, -9.1891e-01], device='cuda:0')
tensor([ 0.1715,  0.6817,  0.5393,  0.5368, -0.0889,  0.5048,  0.9079,  1.0589,
         1.3624,  0.2089,  0.3437,  0.6798,  0.0246, -0.0083, -0.9376],
       device='cuda:0')
Likelihood: -179.5628662109375
State is out of distribution
Likelihoods: tensor([-3.2611, -3.6453, -3.6588, -3.7514, -3.7693, -3.8041, -3.8446, -3.9249,
        -3.9857, -4.1302, -4.1442, -4.2955, -4.3500, -4.4120, -4.5098, -4.7108],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.01933577354146033}
Likelihood grouped sum: {'thumb_middle': 0.30937237666336526}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.9159935710486025
Current yaw: tensor([ 0.0254, -0.0080, -0.9367], device='cuda:0')
2 thumb_middle
tensor([ 0.1715,  0.6818,  0.5391,  0.5366, -0.0892,  0.5049,  0.9080,  1.0574,
         1.3625,  0.2088,  0.3435,  0.6799,  0.0240, -0.0060, -0.9381],
       device='cuda:0')
Solve time for step 1 (global step 7) 3.957249592989683
Current ori: tensor([ 0.0251, -0.0051, -0.9378], device='cuda:0')
Index force: tensor([0.5640, 0.5353, 0.5544], device='cuda:0')
tensor([ 0.0240, -0.0026, -0.9385], device='cuda:0')
tensor([ 0.1658,  0.7201,  0.4840,  0.5005, -0.1622,  0.4676,  0.8820,  0.9623,
         1.2788,  0.2317,  0.2666,  0.8108,  0.0163, -0.0084, -0.9186],
       device='cuda:0')
Solve time for step 2 (global step 8) 3.5590340449707583
Current ori: tensor([ 0.0179, -0.0090, -0.9166], device='cuda:0')
Index force: tensor([0.5361, 0.5572], device='cuda:0')
tensor([ 0.0179, -0.0090, -0.9166], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.1580,  0.7602,  0.4189,  0.4551, -0.1813,  0.4679,  0.8825,  0.9000,
         1.1993,  0.3015,  0.2627,  0.9448,  0.0346, -0.0543, -1.3631],
       device='cuda:0')
Solve time for step 3 (global step 9) 3.529823275981471
Current ori: tensor([ 0.0154, -0.0591, -1.3615], device='cuda:0')
Index force: tensor([0.6168], device='cuda:0')
tensor([ 0.0154, -0.0591, -1.3615], device='cuda:0')
Current yaw: tensor([ 0.0181,  0.0090, -0.8687], device='cuda:0')
3 turn
Likelihood: -128.58363342285156
Sampling time 3.2625103609170765
tensor([ 0.0920,  0.7136,  0.4226,  0.4070, -0.1160,  0.5427,  0.9369,  0.8922,
         1.1656,  0.3905,  0.2875,  1.1426,  0.0180,  0.0079, -0.8683],
       device='cuda:0')
Solve time for step 1 (global step 10) 8.225508250994608
Current ori: tensor([ 0.0208,  0.0035, -0.8659], device='cuda:0')
Middle force: tensor([0.8498, 0.7545, 1.8822, 1.0334, 0.5104, 0.8317, 0.5474, 1.3337, 0.7171,
        0.8365, 0.9189, 0.7351], device='cuda:0')
Thumb force: tensor([1.4597, 1.0078, 1.0329, 2.1126, 0.8258, 1.2489, 0.5400, 0.9019, 0.8253,
        1.2402, 1.5227, 1.0668], device='cuda:0')
Index force: tensor([0.6177, 0.9536, 1.1215, 0.7085, 0.7930, 0.5503, 0.7187, 0.5964, 0.5332,
        0.6783, 0.6825, 0.8975], device='cuda:0')
tensor([ 0.0208,  0.0035, -0.8659], device='cuda:0')
tensor([ 0.0989,  0.7671,  0.3591,  0.3844, -0.1178,  0.5343,  0.9285,  0.9650,
         1.2673,  0.2786,  0.2840,  0.9447,  0.0021, -0.0033, -1.1419],
       device='cuda:0')
Likelihood: -151.05526733398438
Solve time for step 2 (global step 11) 7.63831317005679
Current ori: tensor([ 1.0590e-03, -3.5305e-03, -1.1430e+00], device='cuda:0')
Middle force: tensor([1.7495, 1.9874, 1.4020, 0.6922, 1.6709, 1.4530, 0.6233, 1.5478, 0.5113,
        0.5015, 0.5280], device='cuda:0')
Thumb force: tensor([0.8552, 1.1882, 2.6261, 1.4169, 3.6239, 1.0812, 0.6414, 1.6162, 0.8017,
        0.8609, 0.9291], device='cuda:0')
Index force: tensor([1.0319, 1.0600, 1.2055, 0.6755, 0.9214, 0.5909, 0.7866, 0.5941, 0.5581,
        0.5903, 0.5589], device='cuda:0')
tensor([ 1.0590e-03, -3.5305e-03, -1.1430e+00], device='cuda:0')
tensor([ 9.9380e-02,  7.1597e-01,  4.3238e-01,  4.2937e-01, -1.1922e-01,
         5.4327e-01,  9.3234e-01,  9.6475e-01,  1.2752e+00,  2.4182e-01,
         2.5342e-01,  1.0176e+00,  8.6120e-03,  1.4507e-04, -1.0753e+00],
       device='cuda:0')
Likelihood: -117.85697937011719
Solve time for step 3 (global step 12) 7.228628630051389
Current ori: tensor([ 0.0089,  0.0012, -1.0751], device='cuda:0')
Middle force: tensor([1.9474, 1.3978, 0.6844, 1.6400, 1.4209, 0.6190, 1.5247, 0.5107, 0.5012,
        0.5260], device='cuda:0')
Thumb force: tensor([1.1490, 2.5483, 1.3887, 3.5220, 1.0630, 0.6342, 1.5697, 0.7907, 0.8525,
        0.9159], device='cuda:0')
Index force: tensor([1.0343, 1.1694, 0.6693, 0.9021, 0.5872, 0.7754, 0.5888, 0.5556, 0.5864,
        0.5564], device='cuda:0')
tensor([ 7.7215e-03,  8.6446e-04, -1.0752e+00], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.0995,  0.6917,  0.4545,  0.4448, -0.1251,  0.6050,  0.9716,  0.9737,
         1.2921,  0.2242,  0.2367,  0.9857,  0.0498, -0.0570, -1.5884],
       device='cuda:0')
Likelihood: -170.75177001953125
State is out of distribution
Likelihoods: tensor([-2.7063, -2.9716, -3.2102, -3.4383, -3.5643, -4.7860, -5.1273, -5.4252,
        -5.4555, -5.5330, -5.6107, -5.8575, -5.9451, -5.9954, -6.2620, -6.2993],
       device='cuda:0')
Contact modes ['index' 'index' 'index' 'thumb_middle' 'thumb_middle' 'index'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'index': 0.04167414066209282, 'thumb_middle': 0.007864178739883603}
Likelihood grouped sum: {'index': 0.1666965626483713, 'thumb_middle': 0.09437014487860325}
Contact mode with highest likelihood sum: index
Plan time: 1.9121546159731224
Current yaw: tensor([ 0.0496, -0.0573, -1.5866], device='cuda:0')
4 index
tensor([ 0.0993,  0.6915,  0.4545,  0.4449, -0.1248,  0.6049,  0.9714,  0.9726,
         1.2923,  0.2244,  0.2367,  0.9856,  0.0493, -0.0577, -1.5864],
       device='cuda:0')
Solve time for step 1 (global step 13) 4.5759718210902065
Current ori: tensor([ 0.0444, -0.0564, -1.5876], device='cuda:0')
Middle force: tensor([0.5687, 0.5616, 0.5742], device='cuda:0')
Thumb force: tensor([0.5162, 0.5462, 0.5554], device='cuda:0')
tensor([ 0.0445, -0.0573, -1.5872], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.1317,  0.5915,  0.4468,  0.4747, -0.1047,  0.6383,  0.9719,  0.9551,
         1.3461,  0.2313,  0.2732,  0.9127,  0.3291, -0.2379, -2.4668],
       device='cuda:0')
Solve time for step 2 (global step 14) 4.395682057947852
Current ori: tensor([ 0.3300, -0.2376, -2.4708], device='cuda:0')
Middle force: tensor([0.6216, 0.6547], device='cuda:0')
Thumb force: tensor([0.5163, 0.5192], device='cuda:0')
tensor([ 0.3300, -0.2376, -2.4708], device='cuda:0')
tensor([ 0.1658,  0.2806,  0.4853,  0.5255, -0.1452,  0.9831,  0.9641,  0.8983,
         1.3377,  0.2332,  0.3948,  0.9913,  0.3330, -0.2240, -2.4202],
       device='cuda:0')
Solve time for step 3 (global step 15) 4.0692322649993
Current ori: tensor([ 0.3342, -0.2234, -2.4195], device='cuda:0')
Middle force: tensor([0.5277], device='cuda:0')
Thumb force: tensor([0.5200], device='cuda:0')
tensor([ 0.3342, -0.2234, -2.4195], device='cuda:0')
Current yaw: tensor([ 0.3475, -0.2080, -2.4133], device='cuda:0')
5 turn
Likelihood: -434.18963623046875
State is out of distribution
Likelihoods: tensor([-7.8341, -8.0936, -8.1865, -8.3494, -8.5172, -8.7695, -8.8005, -8.8326,
        -8.9207, -8.9214, -9.0073, -9.0751, -9.1623, -9.3482, -9.5011, -9.7559],
       device='cuda:0')
Contact modes ['thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'thumb_middle': 0.00016857566253370348}
Likelihood grouped sum: {'thumb_middle': 0.0026972106005392557}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.9119263099273667
Current yaw: tensor([ 1.1906, -0.9458, -1.2521], device='cuda:0')
6 thumb_middle
tensor([ 0.1591,  0.2760,  0.5972,  0.5740, -0.1489,  1.0442,  0.9343,  0.8002,
         1.3268,  0.2483,  0.5330,  1.0254,  1.6807, -0.7800, -2.1766],
       device='cuda:0')
Solve time for step 1 (global step 16) 3.8072919729165733
Current ori: tensor([ 1.6762, -0.7790, -2.1831], device='cuda:0')
Index force: tensor([0.4127, 0.4583, 0.3208], device='cuda:0')
tensor([ 1.6762, -0.7790, -2.1831], device='cuda:0')
tensor([ 0.2093,  0.3360,  0.5966,  0.5205, -0.2438,  0.9143,  0.9011,  0.8004,
         1.2184,  0.2081,  0.3438,  1.0191,  1.6776, -0.7780, -2.1764],
       device='cuda:0')
Solve time for step 2 (global step 17) 3.7200385329779238
Current ori: tensor([ 1.6801, -0.7808, -2.1851], device='cuda:0')
Index force: tensor([0.5726, 0.4479], device='cuda:0')
tensor([ 1.6801, -0.7808, -2.1851], device='cuda:0')
tensor([ 0.0728,  0.6704,  0.6018,  0.3909, -0.1756,  0.8540,  0.9215,  0.8434,
         1.2178,  0.2263,  0.2645,  1.0286,  1.6784, -0.7774, -2.1762],
       device='cuda:0')
Solve time for step 3 (global step 18) 3.4982195630436763
Current ori: tensor([ 1.6871, -0.7788, -2.1792], device='cuda:0')
Index force: tensor([0.5387], device='cuda:0')
tensor([ 1.6871, -0.7788, -2.1792], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continueProbably dropped the object
tensor([ 1.6826, -0.7784, -2.1825], device='cuda:0')
Likelihood: -731.5894775390625
State is out of distribution
{}

Trial 2
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([ 1.6711, -0.7763, -2.1754], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-5.9460e-04, -3.0321e-02,  2.6839e+00], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([ 4.6499e-04, -2.9621e-02,  2.6750e+00], device='cuda:0')
1 turn
Likelihood: -59.938079833984375
Sampling time 3.275159619981423
tensor([ 1.4510e-01,  5.9490e-01,  5.9873e-01,  5.9883e-01, -9.4976e-02,
         5.3472e-01,  8.9770e-01,  9.5674e-01,  1.2062e+00,  2.9540e-01,
         2.5797e-01,  1.1720e+00, -2.3456e-03, -2.7337e-02,  2.6751e+00],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.122034674976021
Current ori: tensor([ 1.0582e-03, -2.9084e-02,  2.6763e+00], device='cuda:0')
Middle force: tensor([1.0015, 1.3618, 0.6537, 1.2813, 0.5275, 0.6592, 0.9683, 1.3255, 1.3793,
        0.8488, 1.3423, 1.1085], device='cuda:0')
Thumb force: tensor([1.4405, 1.1324, 1.3200, 1.1853, 0.8938, 0.6452, 1.5219, 1.6924, 1.1367,
        1.6743, 1.0198, 1.5232], device='cuda:0')
Index force: tensor([0.7365, 0.6510, 1.1315, 1.0857, 0.5386, 0.8937, 0.8365, 0.8198, 0.7747,
        0.8730, 0.8039, 0.8676], device='cuda:0')
tensor([ 1.0582e-03, -2.9084e-02,  2.6763e+00], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.1166,  0.6193,  0.5603,  0.5421, -0.1169,  0.5349,  0.9217,  0.9808,
         1.2536,  0.2795,  0.3004,  1.0169,  0.0148, -0.0128,  2.1998],
       device='cuda:0')
Likelihood: -46.895904541015625
Solve time for step 2 (global step 1) 7.773598187952302
Current ori: tensor([ 0.0147, -0.0128,  2.1996], device='cuda:0')
Middle force: tensor([1.2815, 0.6902, 1.2430, 0.5224, 0.7000, 0.5239, 0.7251, 1.1819, 0.9143,
        1.6268, 1.3439], device='cuda:0')
Thumb force: tensor([1.1326, 1.2611, 1.1767, 0.8489, 0.7801, 0.7673, 0.8505, 0.8662, 0.8417,
        0.8536, 0.7888], device='cuda:0')
Index force: tensor([0.6666, 1.1289, 1.0878, 0.5285, 0.7998, 0.5676, 0.5577, 0.5922, 0.7164,
        0.5579, 0.8121], device='cuda:0')
tensor([ 0.0147, -0.0128,  2.1996], device='cuda:0')
Apply perturbation now **TO SIDE OF OBJECT**. Press <ENTER> to continuetensor([ 0.1049,  0.6297,  0.5343,  0.5291, -0.1180,  0.5650,  0.9408,  0.9853,
         1.2577,  0.2651,  0.3054,  0.9590,  0.0291, -0.0180,  2.0242],
       device='cuda:0')
Likelihood: -93.08192443847656
Solve time for step 3 (global step 2) 7.262384922942147
Current ori: tensor([ 0.0282, -0.0183,  2.0255], device='cuda:0')
Middle force: tensor([0.7044, 1.2269, 0.5218, 0.6926, 0.5208, 0.7099, 1.1474, 0.9031, 1.5961,
        1.3209], device='cuda:0')
Thumb force: tensor([1.1957, 1.1132, 0.8265, 0.7552, 0.7469, 0.8169, 0.8372, 0.8087, 0.8218,
        0.7507], device='cuda:0')
Index force: tensor([1.0714, 1.0429, 0.5262, 0.7771, 0.5586, 0.5534, 0.5852, 0.7034, 0.5488,
        0.7842], device='cuda:0')
tensor([ 0.0282, -0.0183,  2.0255], device='cuda:0')
tensor([ 0.0996,  0.6544,  0.4998,  0.5039, -0.1178,  0.5653,  0.9408,  0.9807,
         1.2830,  0.2297,  0.3209,  0.8958,  0.0256, -0.0218,  1.9976],
       device='cuda:0')
Likelihood: -146.65719604492188
Solve time for step 4 (global step 3) 6.8397475680103526
Current ori: tensor([ 0.0253, -0.0223,  1.9984], device='cuda:0')
Middle force: tensor([1.2030, 0.5210, 0.6861, 0.5181, 0.6922, 1.1139, 0.8920, 1.5561, 1.2931],
       device='cuda:0')
Thumb force: tensor([1.0662, 0.8110, 0.7323, 0.7286, 0.7924, 0.8131, 0.7800, 0.7996, 0.7226],
       device='cuda:0')
Index force: tensor([0.9977, 0.5244, 0.7591, 0.5511, 0.5495, 0.5793, 0.6909, 0.5431, 0.7598],
       device='cuda:0')
tensor([ 0.0253, -0.0223,  1.9984], device='cuda:0')
Apply perturbation now **INTO PALM**. Press <ENTER> to continuetensor([ 0.0820,  0.6883,  0.5136,  0.5057, -0.0989,  0.5728,  0.9596,  0.9863,
         1.2919,  0.2261,  0.3564,  0.8026,  0.3093, -0.2265,  1.3920],
       device='cuda:0')
Likelihood: -345.9751281738281
State is out of distribution
Likelihoods: tensor([-6.1432, -6.6946, -6.8063, -7.7297, -7.8928, -7.9069, -7.9954, -7.9959,
        -8.0593, -8.1193, -8.2200, -8.3196, -8.3263, -8.4893, -8.5539, -8.9764],
       device='cuda:0')
Contact modes ['index' 'thumb_middle' 'index' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle' 'thumb_middle'
 'thumb_middle' 'thumb_middle' 'thumb_middle']
Likelihood grouped mean: {'index': 0.0016274037032334965, 'thumb_middle': 0.00035616418368332296}
Likelihood grouped sum: {'index': 0.003254807406466993, 'thumb_middle': 0.004986298571566522}
Contact mode with highest likelihood sum: thumb_middle
Plan time: 1.957282733055763
Current yaw: tensor([ 1.6346, -0.7722,  0.8843], device='cuda:0')
2 thumb_middle
tensor([ 0.0817,  0.6866,  0.5136,  0.5057, -0.0991,  0.5728,  0.9597,  0.9866,
         1.3138,  0.2232,  0.3692,  0.7974,  1.6240, -0.7692,  0.8891],
       device='cuda:0')
Solve time for step 1 (global step 4) 3.9589215150335804
Current ori: tensor([ 1.6365, -0.7725,  0.8909], device='cuda:0')
Index force: tensor([0.4712, 0.5096, 0.5072], device='cuda:0')
tensor([ 1.6365, -0.7725,  0.8909], device='cuda:0')
tensor([ 0.2712,  0.7044,  0.8351,  0.5122, -0.3255,  0.3245,  0.8770,  0.9329,
         1.3128,  0.2217,  0.3421,  0.9641,  1.6256, -0.7682,  0.8897],
       device='cuda:0')
