Hardware mode
Datetime: .04.26.25:06:48:57
Config: {'T': 3, 'T_orig': 12, 'receding_horizon': False, 'num_steps': 8, 'num_turns': 1, 'max_recovery_stages': 4, 'num_trials': 10, 'num_episodes': 25, 'visualize': True, 'experiment_name': 'allegro_screwdriver_safe_rl_recovery_hardware', 'mode': 'hardware', 'fingers': ['index', 'middle', 'thumb'], 'object_type': 'screwdriver', 'sim_device': 'cpu', 'friction_coefficient': 1.0, 'kp': 3.0, 'heuristic': 1000, 'max_depth': 11, 'goal': -1.5, 'prior': 1, 'multi_particle_search': True, 'replan': False, 'visualize_plan': False, 'visualize_recovery_plan': False, 'visualize_contact_plan': False, 'optimize_force': True, 'exclude_index': False, 'projected': False, 'use_saved_plans': True, 'use_saved_noise': False, 'use_guidance': False, 'sample_contact': False, 'use_partial_constraint': True, 'sine_cosine': True, 'project_state': False, 'compute_recovery_trajectory': False, 'rl_adjustment': False, 'test_recovery_trajectory': False, 'perturb_action': False, 'randomize_obj_start': True, 'external_wrench_perturb': True, 'viz_states': False, 'diff_init': True, 'live_recovery': True, 'new_projection': True, 'trajectory_condition': True, 'generate_context': True, 'true_s0': False, 'task_diffuse_goal': False, 'recovery_diff_traj': True, 'obj_gravity': True, 'type': 'diffusion', 'model_path': '/home/abhinav/Documents/ccai/data/training/allegro_screwdriver/safe_rl/safety_critic.pt', 'model_path_orig': 'data/training/allegro_screwdriver/allegro_screwdriver_pi_2_diffusion/allegro_screwdriver_diffusion.pt', 'likelihood_threshold': -160.0, 'drop_threshold': -1250, 'project_threshold': -105.0, 'sac_batch_size': 64, 'start_ind': 0, 'end_ind': 50, 'device': 'cuda:0', 'recovery_controller': 'mppi', 'OOD_metric': 'q_function', 'lambda_': 0.01, 'q_cutoff': 0.01, 'controllers': {'csvgd': {'N': 16, 'alpha_J': 0.01, 'alpha_C': 1, 'step_size': 0.1, 'momentum': 0.0, 'online_iters': 25, 'warmup_iters': 25, 'resample_steps': 16, 'resample_sigma': 0.01, 'resample_temperature': 0.1, 'penalty': 1000000, 'collision_checking': False, 'joint_friction': 0.0}}, 'ee_names': {'index': 'allegro_hand_hitosashi_finger_finger_0_aftc_base_link', 'middle': 'allegro_hand_naka_finger_finger_1_aftc_base_link', 'ring': 'allegro_hand_kusuri_finger_finger_2_aftc_base_link', 'thumb': 'allegro_hand_oya_finger_3_aftc_base_link'}, 'obj_dof': 3}
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]
[ models/temporal ] Channel dimensions: [(37, 128), (128, 256), (256, 512)]

Trial 1
No action perturbation this trial
Random perturbation %: 0.33
Loaded trajectory sampler
Current yaw: tensor([-0.0181,  0.0284,  0.6654], device='cuda:0')
Ready to pregrasp. Press <ENTER> to continue.tensor([-0.0339,  0.0185,  0.6572], device='cuda:0')
Pregrasp complete. Ready to execute. Press <ENTER> to continue.Current yaw: tensor([-0.0349,  0.0132,  0.6473], device='cuda:0')
1 turn
Sampling time 3.4773791630286723
tensor([ 0.1112,  0.5933,  0.5800,  0.5888, -0.1125,  0.5414,  0.9160,  0.8860,
         1.2092,  0.3244,  0.2684,  1.1359, -0.0387,  0.0138,  0.6452],
       device='cuda:0')
Solve time for step 1 (global step 0) 8.280625630985014
Current ori: tensor([-0.0386,  0.0140,  0.6446], device='cuda:0')
Middle force: tensor([0.5896, 1.0863, 0.5019, 1.1173, 1.7387, 1.1787, 1.0663, 0.6691, 1.0128,
        1.3689, 1.2654, 0.9213], device='cuda:0')
Thumb force: tensor([1.8811, 1.7457, 0.5792, 1.0128, 1.0482, 1.0827, 1.0627, 1.2128, 0.8630,
        0.7512, 1.2908, 1.2870], device='cuda:0')
Index force: tensor([0.8795, 0.8915, 0.9450, 0.9325, 0.7794, 0.8335, 0.5553, 0.5084, 0.7086,
        0.6657, 0.7815, 0.5578], device='cuda:0')
Q function output: 0.00
tensor([-0.0386,  0.0140,  0.6446], device='cuda:0')
tensor([ 0.1085,  0.6256,  0.5548,  0.5403, -0.1142,  0.5415,  0.9027,  0.9097,
         1.2560,  0.2956,  0.2664,  1.0360, -0.0487,  0.0171,  0.5319],
       device='cuda:0')
Solve time for step 2 (global step 1) 7.750513129984029
Current ori: tensor([-0.0476,  0.0172,  0.5312], device='cuda:0')
Middle force: tensor([1.0783, 0.5049, 1.0325, 1.3574, 1.3563, 1.3294, 0.5094, 1.2047, 1.1284,
        1.3890, 0.8789], device='cuda:0')
Thumb force: tensor([1.6614, 0.5797, 0.9860, 1.0588, 1.3498, 0.9614, 0.8315, 1.2371, 0.7815,
        0.7796, 1.2104], device='cuda:0')
Index force: tensor([0.8714, 0.9261, 0.8879, 0.6136, 0.8499, 0.6089, 0.9784, 0.7475, 0.5627,
        0.6586, 0.6527], device='cuda:0')
Q function output: 0.00
tensor([-0.0476,  0.0172,  0.5312], device='cuda:0')
tensor([ 0.1133,  0.6336,  0.5495,  0.5382, -0.1174,  0.5207,  0.9053,  0.9711,
         1.2891,  0.2750,  0.3029,  0.8928, -0.0568,  0.0210,  0.3664],
       device='cuda:0')
Solve time for step 3 (global step 2) 7.435842470964417
Current ori: tensor([-0.0559,  0.0201,  0.3674], device='cuda:0')
Middle force: tensor([0.5042, 0.9926, 1.3305, 1.3040, 1.2970, 0.5055, 1.1353, 1.1011, 1.3349,
        0.8489], device='cuda:0')
Thumb force: tensor([0.5626, 0.9548, 1.0136, 1.3100, 0.9296, 0.8136, 1.1832, 0.7603, 0.7476,
        1.1646], device='cuda:0')
Index force: tensor([0.8915, 0.8618, 0.6063, 0.8237, 0.6015, 0.9592, 0.7295, 0.5559, 0.6448,
        0.6404], device='cuda:0')
Q function output: 0.00
tensor([-0.0559,  0.0201,  0.3674], device='cuda:0')
tensor([ 0.1140,  0.6488,  0.5343,  0.5227, -0.1135,  0.5201,  0.9069,  0.9790,
         1.3043,  0.2597,  0.3142,  0.8181, -0.0544,  0.0166,  0.3228],
       device='cuda:0')
Solve time for step 4 (global step 3) 7.201087243971415
Current ori: tensor([-0.0535,  0.0161,  0.3229], device='cuda:0')
Middle force: tensor([0.9660, 1.3112, 1.2637, 1.2702, 0.5039, 1.0762, 1.0766, 1.2899, 0.8211],
       device='cuda:0')
Thumb force: tensor([0.9185, 0.9749, 1.2707, 0.8994, 0.7812, 1.1365, 0.7386, 0.7175, 1.1258],
       device='cuda:0')
Index force: tensor([0.8284, 0.5997, 0.7993, 0.5952, 0.9328, 0.7124, 0.5509, 0.6339, 0.6305],
       device='cuda:0')
Q function output: 0.00
tensor([-0.0541,  0.0166,  0.3225], device='cuda:0')
tensor([ 0.1236,  0.6449,  0.5478,  0.5357, -0.1143,  0.5153,  0.9219,  1.0234,
         1.3191,  0.2488,  0.3387,  0.7278, -0.0438,  0.0231,  0.2500],
       device='cuda:0')
Solve time for step 5 (global step 4) 6.774369745049626
Current ori: tensor([-0.0431,  0.0228,  0.2503], device='cuda:0')
Middle force: tensor([1.2887, 1.2340, 1.2390, 0.5004, 1.0271, 1.0532, 1.2474, 0.7970],
       device='cuda:0')
Thumb force: tensor([0.9366, 1.2346, 0.8765, 0.8099, 1.0945, 0.7200, 0.6940, 1.0892],
       device='cuda:0')
Index force: tensor([0.5912, 0.7767, 0.5885, 0.9373, 0.6972, 0.5457, 0.6234, 0.6213],
       device='cuda:0')
Q function output: 0.00
tensor([-0.0431,  0.0228,  0.2503], device='cuda:0')
tensor([ 0.1242,  0.6460,  0.5346,  0.5473, -0.1159,  0.5064,  0.9214,  1.0553,
         1.3330,  0.2522,  0.3904,  0.5983, -0.0363,  0.0258,  0.1880],
       device='cuda:0')
Solve time for step 6 (global step 5) 6.364751202985644
Current ori: tensor([-0.0373,  0.0271,  0.1876], device='cuda:0')
Middle force: tensor([0.9406, 0.7861, 0.5716, 1.1575, 0.5524, 0.8835, 1.1056],
       device='cuda:0')
Thumb force: tensor([0.8890, 0.5773, 0.5092, 0.7625, 0.5503, 0.5147, 1.4971],
       device='cuda:0')
Index force: tensor([0.6277, 0.8067, 0.7170, 0.5052, 0.5261, 0.5000, 0.7833],
       device='cuda:0')
Q function output: 0.00
tensor([-0.0367,  0.0265,  0.1866], device='cuda:0')
tensor([ 0.1242,  0.6440,  0.5438,  0.5457, -0.1155,  0.4971,  0.9362,  1.0688,
         1.3678,  0.2115,  0.3921,  0.5426, -0.0413,  0.0284,  0.1318],
       device='cuda:0')
Solve time for step 7 (global step 6) 5.7695724739460275
Current ori: tensor([-0.0409,  0.0270,  0.1318], device='cuda:0')
Middle force: tensor([1.1781, 0.5001, 0.9236, 0.9947, 1.1533, 0.7430], device='cuda:0')
Thumb force: tensor([0.8249, 0.7812, 0.9849, 0.6839, 0.6407, 1.0007], device='cuda:0')
Index force: tensor([0.5778, 0.8962, 0.6685, 0.5350, 0.5999, 0.5987], device='cuda:0')
Q function output: 0.00
tensor([-0.0409,  0.0270,  0.1318], device='cuda:0')
tensor([ 0.1269,  0.6440,  0.5424,  0.5472, -0.1148,  0.4901,  0.9402,  1.0929,
         1.3727,  0.2096,  0.4312,  0.4347, -0.0431,  0.0255,  0.1044],
       device='cuda:0')
Solve time for step 8 (global step 7) 5.641226364998147
Current ori: tensor([-0.0428,  0.0234,  0.1057], device='cuda:0')
Middle force: tensor([0.5001, 0.8839, 0.9668, 1.1094, 0.7189], device='cuda:0')
Thumb force: tensor([0.7230, 0.9269, 0.6668, 0.6155, 0.9534], device='cuda:0')
Index force: tensor([0.8589, 0.6591, 0.5308, 0.5905, 0.5896], device='cuda:0')
Q function output: 0.00
tensor([-0.0428,  0.0234,  0.1057], device='cuda:0')
tensor([ 0.1253,  0.6614,  0.5277,  0.5370, -0.1136,  0.4879,  0.9423,  1.1002,
         1.3934,  0.1831,  0.4580,  0.3535, -0.0492,  0.0245,  0.0746],
       device='cuda:0')
Solve time for step 9 (global step 8) 5.23192866507452
Current ori: tensor([-0.0491,  0.0244,  0.0742], device='cuda:0')
Middle force: tensor([1.0814, 0.5397, 0.8114, 1.0478], device='cuda:0')
Thumb force: tensor([0.6913, 0.5265, 0.5056, 1.3592], device='cuda:0')
Index force: tensor([0.5023, 0.5225, 0.5000, 0.7293], device='cuda:0')
Q function output: 0.00
tensor([-0.0499,  0.0257,  0.0749], device='cuda:0')
tensor([ 0.1316,  0.6458,  0.5531,  0.5336, -0.1145,  0.4814,  0.9600,  1.1102,
         1.4156,  0.1396,  0.4624,  0.3036, -0.0511,  0.0285,  0.0247],
       device='cuda:0')
Solve time for step 10 (global step 9) 5.09045275405515
Current ori: tensor([-0.0508,  0.0301,  0.0242], device='cuda:0')
Middle force: tensor([1.0391, 1.0095, 0.7577], device='cuda:0')
Thumb force: tensor([0.6285, 0.9993, 1.0061], device='cuda:0')
Index force: tensor([0.6293, 0.6685, 0.5226], device='cuda:0')
Q function output: 0.00
tensor([-0.0508,  0.0301,  0.0242], device='cuda:0')
tensor([ 0.1387,  0.6461,  0.5601,  0.5348, -0.1127,  0.4879,  0.9662,  1.1246,
         1.4175,  0.1390,  0.4635,  0.2802, -0.0550,  0.0234, -0.0150],
       device='cuda:0')
Solve time for step 11 (global step 10) 4.862131556961685
Current ori: tensor([-0.0480,  0.0244, -0.0148], device='cuda:0')
Middle force: tensor([0.6402, 0.9414], device='cuda:0')
Thumb force: tensor([1.1155, 0.5024], device='cuda:0')
Index force: tensor([0.6232, 0.6299], device='cuda:0')
Q function output: 0.00
tensor([-0.0480,  0.0244, -0.0148], device='cuda:0')
tensor([ 0.1432,  0.6452,  0.5676,  0.5345, -0.1113,  0.4815,  0.9822,  1.1295,
         1.4342,  0.1216,  0.4632,  0.2625, -0.0445,  0.0226, -0.0431],
       device='cuda:0')
Solve time for step 12 (global step 11) 4.59152947505936
Current ori: tensor([-0.0446,  0.0221, -0.0443], device='cuda:0')
Middle force: tensor([0.9284], device='cuda:0')
Thumb force: tensor([0.5011], device='cuda:0')
Index force: tensor([0.6311], device='cuda:0')
Q function output: 0.00
tensor([-0.0446,  0.0221, -0.0443], device='cuda:0')
Current yaw: tensor([-0.0358,  0.0094, -0.0624], device='cuda:0')
2 turn
